<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>1. Hyperelasticity &mdash; Jafar Arash Mehr 2022 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="2. Multi-Physics Problem" href="multi-physics.html" />
    <link rel="prev" title="Required Packages" href="package.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html">
            <img src="../_static/profile.jpg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Intro.html"><strong>What is this document about?</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="resource.html">Useful Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="package.html">Required Packages</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#"><strong>1. Hyperelasticity</strong></a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">1.1 Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#fully-incompressible-model">1.2 Fully Incompressible Model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#constitutive-equations">1.2.1 Constitutive Equations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#finite-element-implementation">1.2.2 Finite Element Implementation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#nearly-incompressible-model">1.3. Nearly Incompressible Model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">1.3.1. Constitutive Equations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id2">1.3.2 Finite Element Implementation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#compressible-model">1.4. Compressible Model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id3">1.4.1. Constitutive Equations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id4">1.4.2. Finite Element Implementation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#axisymmetric-model">1.5. Axisymmetric Model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#constitutive-equation">1.5.1. Constitutive Equation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id5">1.5.2. Finite Element Implementation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#von-mises-fiber-model">1.6 von-Mises Fiber Model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id7">1.6.1. Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#stress-tensor">1.6.2. Stress Tensor</a></li>
<li class="toctree-l3"><a class="reference internal" href="#strain-energy-function">1.6.3. Strain Energy Function</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id8">1.6.4. Finite Element Implementation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="multi-physics.html"><strong>2. Multi-Physics Problem</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="drug-delivery.html"><strong>3. Drug Delivery</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="optimization.html"><strong>4. Inverse Finite Element (Optimization)</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="Statistical%20Analysis.html"><strong>6. Statistical Analysis</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="Linear%20Regression.html"><strong>7. Linear Regression</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="ML.html"><strong>8. Fundamentals of Machine Learning</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="LDA.html"><strong>9. Machine Learning in Diagnosis</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="contact.html">About the Author</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Jafar Arash Mehr</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li><strong>1. Hyperelasticity</strong></li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/rst/hyperelasticity.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="hyperelasticity">
<h1><strong>1. Hyperelasticity</strong><a class="headerlink" href="#hyperelasticity" title="Permalink to this heading"></a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The reader is encouraged to look at these resources to get started:</p>
<ol class="arabic simple">
<li><p><a class="reference external" href="http://homepages.engineering.auckland.ac.nz/~pkel015/SolidMechanicsBooks/Part_IV/Chapter_1_Hyperelasticity/PDF/Elasticity_04_Isotropic_Hyperelasticity.pdf">Material Models in Continuum Solid Mechanics</a></p></li>
<li><p><a class="reference external" href="https://www.sciencedirect.com/science/article/pii/0045782596010353">Finite element implementation of incompressible, transversely isotropic hyperelasticity</a></p></li>
<li><p><a class="reference external" href="https://asmedigitalcollection.asme.org/biomechanical/article/134/1/011005/455684">FEBio: Finite Elements for Biomechanics</a></p></li>
<li><p><a class="reference external" href="http://solidmechanics.org/Text/Chapter3_5/Chapter3_5.php">Applied Mechanics of Solids</a></p></li>
</ol>
</div>
<section id="introduction">
<h2>1.1 Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading"></a></h2>
<p>The strain energy function <span class="math notranslate nohighlight">\(W\)</span> is defined as:</p>
<div class="math notranslate nohighlight" id="eq-1">
<span id="equation-eq-1"></span><span class="eqno">(1)<a class="headerlink" href="#eq-1" title="Permalink to this equation"></a></span>\[ W=W(I_1 (\textbf {C})),I_2 (\textbf {C})),I_3 (\textbf {C}))\]</div>
<p>In the above equations, <span class="math notranslate nohighlight">\(\textbf {C}\)</span> is the right Cauchy deformation tensor:</p>
<div class="math notranslate nohighlight" id="eq-2">
<span id="equation-eq-2"></span><span class="eqno">(2)<a class="headerlink" href="#eq-2" title="Permalink to this equation"></a></span>\[\textbf {C}=F^TF\]</div>
<p>Where <span class="math notranslate nohighlight">\(F\)</span> is the deformation gradient tensor: <span class="math notranslate nohighlight">\(F=I+\nabla u\)</span>. The Jacobian of <span class="math notranslate nohighlight">\(F\)</span> is defined as its determinant:  <span class="math notranslate nohighlight">\(J= \lvert F \rvert\)</span>.</p>
<p>The <span class="math notranslate nohighlight">\(I_1 (\textbf {C})\)</span>, <span class="math notranslate nohighlight">\(I_2 (\textbf {C})\)</span> and <span class="math notranslate nohighlight">\(I_3 (\textbf {C})\)</span> are the invariants of the <span class="math notranslate nohighlight">\(\textbf {C}\)</span> tensor.</p>
<div class="math notranslate nohighlight" id="eq-3">
<span id="equation-eq-3"></span><span class="eqno">(3)<a class="headerlink" href="#eq-3" title="Permalink to this equation"></a></span>\[ \begin{align}\begin{aligned}I_1=tr(\textbf{C})\\I_2=0.5[(tr \textbf{C})^2-tr(\textbf{C}^2)]\\I_3=det (\textbf{C})\end{aligned}\end{align} \]</div>
<p>The second Piola-Kirchhoff stress is defined as:</p>
<div class="math notranslate nohighlight" id="eq-4">
<span id="equation-eq-4"></span><span class="eqno">(4)<a class="headerlink" href="#eq-4" title="Permalink to this equation"></a></span>\[S=2 \frac{\partial W}{\partial \textbf {C}}\]</div>
<p>After applying the chain rule, we can write the term <span class="math notranslate nohighlight">\(\frac{\partial W}{\partial \textbf {C}}\)</span> as:</p>
<div class="math notranslate nohighlight" id="eq-5">
<span id="equation-eq-5"></span><span class="eqno">(5)<a class="headerlink" href="#eq-5" title="Permalink to this equation"></a></span>\[\frac{\partial W}{\partial \textbf {C}}=\frac{\partial W}{I_1} \frac{\partial I_1}{\textbf {C}} + \frac{\partial W}{I_2} \frac{\partial I_2}{\textbf {C}}+\frac{\partial W}{I_3} \frac{\partial I_3}{\textbf {C}}\]</div>
<p>The first term on the right hand side, we could apply the chain rule to calculate the <span class="math notranslate nohighlight">\(\frac{\partial I_1}{\partial C}\)</span>:</p>
<div class="math notranslate nohighlight" id="eq-6">
<span id="equation-eq-6"></span><span class="eqno">(6)<a class="headerlink" href="#eq-6" title="Permalink to this equation"></a></span>\[\frac{\partial I_1}{\partial C}=\frac{\partial (I_1)_{11}}{C_{ij}} e_i \otimes e_j + \frac{\partial (I_1)_{22}}{C_{ij}} e_i \otimes e_j + \frac{\partial (I_1)_{33}}{C_{ij}} e_i \otimes e_j\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <span class="math notranslate nohighlight">\(e_i\)</span> and <span class="math notranslate nohighlight">\(e_j\)</span> are unit vectors, <span class="math notranslate nohighlight">\(\otimes\)</span> represents the outer product and <span class="math notranslate nohighlight">\(e_i \otimes e_j =0\)</span> if <span class="math notranslate nohighlight">\(i \neq j\)</span>.</p>
</div>
<div class="math notranslate nohighlight" id="eq-7">
<span id="equation-eq-7"></span><span class="eqno">(7)<a class="headerlink" href="#eq-7" title="Permalink to this equation"></a></span>\[\frac{\partial I_1}{\partial C}=e_1 \otimes e_1 +e_2 \otimes e_2 +e_3 \otimes e_3 = \textbf{I}\]</div>
<p>Similarly we can can derive the <span class="math notranslate nohighlight">\(\frac{\partial I_2}{\partial C}\)</span> and <span class="math notranslate nohighlight">\(\frac{\partial I_3}{\partial C}\)</span>:</p>
<div class="math notranslate nohighlight" id="eq-8">
<span id="equation-eq-8"></span><span class="eqno">(8)<a class="headerlink" href="#eq-8" title="Permalink to this equation"></a></span>\[ \begin{align}\begin{aligned}\frac{\partial I_2}{\partial \textbf {C}}= I_1 \textbf {I} - \textbf {C}\\\frac{\partial I_3}{\partial \textbf {C}}= I_2 \textbf {I} - I_1 \textbf {C} + \textbf {C}^2\end{aligned}\end{align} \]</div>
<p>By plugging back the  <a class="reference internal" href="#eq-7"><span class="std std-ref">Equation.7</span></a> and <a class="reference internal" href="#eq-8"><span class="std std-ref">Equation.8</span></a> into the <a class="reference internal" href="#eq-5"><span class="std std-ref">Equation.5</span></a>, we can find the second piola kirchhoff stress as:</p>
<div class="math notranslate nohighlight" id="eq-9">
<span id="equation-eq-9"></span><span class="eqno">(9)<a class="headerlink" href="#eq-9" title="Permalink to this equation"></a></span>\[\textbf {S}= 2 \alpha_1 \textbf {I} + 2 \alpha_2 \textbf {C} + 2 \alpha_3 \textbf {C}^2\]</div>
<p>In <a class="reference internal" href="#eq-9"><span class="std std-ref">Equation.9</span></a>:</p>
<div class="math notranslate nohighlight" id="eq-10">
<span id="equation-eq-10"></span><span class="eqno">(10)<a class="headerlink" href="#eq-10" title="Permalink to this equation"></a></span>\[ \begin{align}\begin{aligned}\alpha_1 =  \frac{\partial W}{\partial I_1} +  \frac{\partial W}{\partial I_2} I_1 +  \frac{\partial W}{\partial I_3} I_2\\\alpha_2 =  -\frac{\partial W}{\partial I_2} -  \frac{\partial W}{\partial I_3} I_1\\\alpha_3 =  \frac{\partial W}{\partial I_3}\end{aligned}\end{align} \]</div>
<p>The Cauchy stress is defined as:</p>
<div class="math notranslate nohighlight" id="eq-11">
<span id="equation-eq-11"></span><span class="eqno">(11)<a class="headerlink" href="#eq-11" title="Permalink to this equation"></a></span>\[\sigma = J^{-1} F F^T \textbf {S}\]</div>
<p>Similar to the <a class="reference internal" href="#eq-1"><span class="std std-ref">Equation.1</span></a> we can define:</p>
<div class="math notranslate nohighlight" id="eq-12">
<span id="equation-eq-12"></span><span class="eqno">(12)<a class="headerlink" href="#eq-12" title="Permalink to this equation"></a></span>\[ W=W(I_1 (\textbf {b})),I_2 (\textbf {b})),I_3 (\textbf {b}))\]</div>
<p>Where <span class="math notranslate nohighlight">\(\textbf {b}\)</span> is the left Cauchy deformation tensor:</p>
<div class="math notranslate nohighlight" id="eq-13">
<span id="equation-eq-13"></span><span class="eqno">(13)<a class="headerlink" href="#eq-13" title="Permalink to this equation"></a></span>\[\textbf {b}=FF^T\]</div>
<p>It should be noted that the invariants of the <span class="math notranslate nohighlight">\(\textbf {b}\)</span> are obtained similar to the <a class="reference internal" href="#eq-3"><span class="std std-ref">Equation.3</span></a>. By taking the same steps shown in the <a class="reference internal" href="#eq-6"><span class="std std-ref">Equation.6</span></a> and <a class="reference internal" href="#eq-7"><span class="std std-ref">Equation.7</span></a></p>
<p>In addition, we take advantage of Cayley-Hamilton theorem:</p>
<div class="math notranslate nohighlight" id="eq-14">
<span id="equation-eq-14"></span><span class="eqno">(14)<a class="headerlink" href="#eq-14" title="Permalink to this equation"></a></span>\[\textbf{b}^3-I_1 \textbf{b}^2+I_2 \textbf{b} - I_3 \textbf{I} =0\]</div>
<p>So the term <span class="math notranslate nohighlight">\(\frac{\partial I_3}{\partial \textbf {b}}\)</span> could be rewritten again:</p>
<div class="math notranslate nohighlight" id="eq-15">
<span id="equation-eq-15"></span><span class="eqno">(15)<a class="headerlink" href="#eq-15" title="Permalink to this equation"></a></span>\[\frac{\partial I_3}{\partial \textbf {b}}= I_3 \textbf {b}^{-1}\]</div>
<p>We can write the <span class="math notranslate nohighlight">\(\frac{\partial W}{\partial \textbf {b}}\)</span>:</p>
<div class="math notranslate nohighlight" id="eq-16">
<span id="equation-eq-16"></span><span class="eqno">(16)<a class="headerlink" href="#eq-16" title="Permalink to this equation"></a></span>\[\frac{\partial W}{\partial \textbf {b}}= (\frac{\partial W}{\partial I_1} + \frac{\partial W}{\partial I_2} I_1) \textbf {I} - \frac{\partial W}{\partial I_2}\textbf {b} +\frac{\partial W}{\partial I_3} I_3 \textbf {b}^{-1}\]</div>
<p>After multiplying the <span class="math notranslate nohighlight">\(\textbf {b}\)</span> tensor into the <a class="reference internal" href="#eq-16"><span class="std std-ref">Equation.16</span></a> and then by substitution in <a class="reference internal" href="#eq-11"><span class="std std-ref">Equation.11</span></a>, the stress could be defined as following:</p>
<div class="math notranslate nohighlight" id="eq-17">
<span id="equation-eq-17"></span><span class="eqno">(17)<a class="headerlink" href="#eq-17" title="Permalink to this equation"></a></span>\[ \sigma=\beta_1 \textbf {I}+\beta_2 \textbf {b}+\beta_3 \textbf {b}^2\]</div>
<p>In the above equation:</p>
<div class="math notranslate nohighlight" id="eq-18">
<span id="equation-eq-18"></span><span class="eqno">(18)<a class="headerlink" href="#eq-18" title="Permalink to this equation"></a></span>\[ \begin{align}\begin{aligned}\beta_1 = 2J^{-1} (\frac{\partial W}{\partial I_3}I_3)\\\beta_2 = 2J^{-1} (\frac{\partial W}{\partial I_1} +  \frac{\partial W}{\partial I_2} I_1)\\\beta_3 = 2J^{-1} (-\frac{\partial W}{\partial I_2})\end{aligned}\end{align} \]</div>
</section>
<section id="fully-incompressible-model">
<h2>1.2 Fully Incompressible Model<a class="headerlink" href="#fully-incompressible-model" title="Permalink to this heading"></a></h2>
<section id="constitutive-equations">
<h3>1.2.1 Constitutive Equations<a class="headerlink" href="#constitutive-equations" title="Permalink to this heading"></a></h3>
<p>For the incompressible Neo-Hookean material, the strain energy function is defined as:</p>
<div class="math notranslate nohighlight" id="eq-19">
<span id="equation-eq-19"></span><span class="eqno">(19)<a class="headerlink" href="#eq-19" title="Permalink to this equation"></a></span>\[W=c_1(I_1-3)\]</div>
<p>For the uniaxial tension, the deformation gradient tensor is expressed as:</p>
<div class="math notranslate nohighlight" id="eq-20">
<span id="equation-eq-20"></span><span class="eqno">(20)<a class="headerlink" href="#eq-20" title="Permalink to this equation"></a></span>\[\begin{split} F=\begin{bmatrix} \lambda_1 &amp; 0 &amp; 0\\0 &amp; \lambda_2 &amp; 0\\0 &amp; 0 &amp; \lambda_3\end{bmatrix}\end{split}\]</div>
<p>Considering the <a class="reference internal" href="#eq-19"><span class="std std-ref">equation.19</span></a> and with respect to <a class="reference internal" href="#eq-17"><span class="std std-ref">equation.17</span></a> and <a class="reference internal" href="#eq-18"><span class="std std-ref">equation.18</span></a> then we can calculate the <span class="math notranslate nohighlight">\(\beta_1\)</span>, <span class="math notranslate nohighlight">\(\beta_2\)</span> and <span class="math notranslate nohighlight">\(\beta_3\)</span>:</p>
<div class="math notranslate nohighlight" id="eq-21">
<span id="equation-eq-21"></span><span class="eqno">(21)<a class="headerlink" href="#eq-21" title="Permalink to this equation"></a></span>\[ \begin{align}\begin{aligned} \beta_1 = 0\\ \beta_2 = 2J^{-1}c_1\\ \beta_3 = 0\end{aligned}\end{align} \]</div>
<p>In the above equation <span class="math notranslate nohighlight">\(c_1= \frac {\mu}{2}\)</span> where  <span class="math notranslate nohighlight">\(\mu\)</span> is the shear modulus. In addition for a fully compressible material, <span class="math notranslate nohighlight">\(J= 1\)</span> so <span class="math notranslate nohighlight">\(\beta_2=\mu\)</span> . According to the <a class="reference internal" href="#eq-20"><span class="std std-ref">equation.20</span></a> and <a class="reference internal" href="#eq-13"><span class="std std-ref">equation.13</span></a> we can calculate the <span class="math notranslate nohighlight">\(\textbf{b}\)</span> as following:</p>
<div class="math notranslate nohighlight" id="eq-22">
<span id="equation-eq-22"></span><span class="eqno">(22)<a class="headerlink" href="#eq-22" title="Permalink to this equation"></a></span>\[\begin{split} \textbf{b}=\begin{bmatrix} {\lambda_1}^2 &amp; 0 &amp; 0\\0 &amp; {\lambda_2}^2  &amp; 0\\0 &amp; 0 &amp; {\lambda_3}^2 \end{bmatrix}\end{split}\]</div>
<p>Then we can write the stress as:</p>
<div class="math notranslate nohighlight" id="eq-23">
<span id="equation-eq-23"></span><span class="eqno">(23)<a class="headerlink" href="#eq-23" title="Permalink to this equation"></a></span>\[\begin{split} \begin{bmatrix} \sigma_{11} &amp; 0 &amp; 0\\0 &amp; 0&amp; 0\\0 &amp; 0 &amp; 0\end{bmatrix} = \beta_{2}\begin{bmatrix} \lambda_{1}^2 &amp; 0 &amp; 0\\0 &amp; \lambda_{2}^2&amp; 0\\0 &amp; 0 &amp; \lambda_{3}^2\end{bmatrix}\end{split}\]</div>
<p>It results in 2 equations:</p>
<div class="math notranslate nohighlight" id="eq-24">
<span id="equation-eq-24"></span><span class="eqno">(24)<a class="headerlink" href="#eq-24" title="Permalink to this equation"></a></span>\[ \begin{align}\begin{aligned}\sigma_{11}=\beta_2 \lambda_{1}^2\\0=\beta_2 \lambda_{2}^2\end{aligned}\end{align} \]</div>
<p>By subtracting the above equations:</p>
<div class="math notranslate nohighlight" id="eq-25">
<span id="equation-eq-25"></span><span class="eqno">(25)<a class="headerlink" href="#eq-25" title="Permalink to this equation"></a></span>\[ \sigma_{11}=(\lambda_{1}^2-\lambda_{2}^2)\beta_{2}\]</div>
<p>It should be noted that in the uniaxial stretch, the stretches in different directions are:</p>
<div class="math notranslate nohighlight" id="eq-26">
<span id="equation-eq-26"></span><span class="eqno">(26)<a class="headerlink" href="#eq-26" title="Permalink to this equation"></a></span>\[\begin{split} \lambda_1=\lambda\\
 \lambda_2=\lambda_3= \frac{1}{\sqrt{\lambda}}\end{split}\]</div>
<p>Then the final form of the stress is presented in this form:</p>
<div class="math notranslate nohighlight" id="eq-27">
<span id="equation-eq-27"></span><span class="eqno">(27)<a class="headerlink" href="#eq-27" title="Permalink to this equation"></a></span>\[ \sigma_{11}=\mu(\lambda^2-\frac{1}{\lambda})\]</div>
<p>For the Biaxial tension, the deformation gradients tensor is defined as:</p>
<div class="math notranslate nohighlight" id="eq-28">
<span id="equation-eq-28"></span><span class="eqno">(28)<a class="headerlink" href="#eq-28" title="Permalink to this equation"></a></span>\[\begin{split} F=\begin{bmatrix} \lambda &amp; 0 &amp; 0\\0 &amp; \lambda &amp; 0\\0 &amp; 0 &amp; \frac {1}{\lambda^2}\end{bmatrix}\end{split}\]</div>
<p>As <span class="math notranslate nohighlight">\(\beta_1\)</span> and <span class="math notranslate nohighlight">\(\beta_3\)</span> are equal to zero, after calculating the <span class="math notranslate nohighlight">\(\textbf{b}\)</span> tensor we can write the <a class="reference internal" href="#eq-17"><span class="std std-ref">Equation.17</span></a> in this form:</p>
<div class="math notranslate nohighlight" id="eq-29">
<span id="equation-eq-29"></span><span class="eqno">(29)<a class="headerlink" href="#eq-29" title="Permalink to this equation"></a></span>\[\begin{split} \begin{bmatrix} \sigma_{11} &amp; 0 &amp; 0\\0 &amp; \sigma_{22} &amp; 0\\0 &amp; 0 &amp; 0\end{bmatrix}= \beta_1 \begin{bmatrix} \lambda^2 &amp; 0 &amp; 0\\0 &amp; \lambda^2 &amp; 0\\0 &amp; 0 &amp; \frac{1}{\lambda^4}\end{bmatrix}\end{split}\]</div>
<p>It results in 2 equations:</p>
<div class="math notranslate nohighlight" id="eq-30">
<span id="equation-eq-30"></span><span class="eqno">(30)<a class="headerlink" href="#eq-30" title="Permalink to this equation"></a></span>\[\begin{split} \sigma_{11}= \beta_2 \lambda^2\\
 0= \beta_2 \frac{1}{\lambda^4}\end{split}\]</div>
<p>By subtracting the above equations:</p>
<div class="math notranslate nohighlight" id="eq-31">
<span id="equation-eq-31"></span><span class="eqno">(31)<a class="headerlink" href="#eq-31" title="Permalink to this equation"></a></span>\[ \sigma_{11}= \mu (\lambda^2-\frac{1}{\lambda^4})\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Alternative Way</strong></p>
<p>The stress is defined as following:</p>
<div class="math notranslate nohighlight" id="eq-32">
<span id="equation-eq-32"></span><span class="eqno">(32)<a class="headerlink" href="#eq-32" title="Permalink to this equation"></a></span>\[ \sigma= \alpha_1 \lambda_i^{2} + \alpha_{-1} \lambda_i^{-2}-p\]</div>
<p>Where:</p>
<div class="math notranslate nohighlight" id="eq-33">
<span id="equation-eq-33"></span><span class="eqno">(33)<a class="headerlink" href="#eq-33" title="Permalink to this equation"></a></span>\[\begin{split} \alpha_1= 2 \frac{\partial W}{\partial I_1}\\
 \alpha_{-1}= -2 \frac{\partial W}{\partial I_2}\end{split}\]</div>
<p>The parameter <span class="math notranslate nohighlight">\(p\)</span> is defined as hydrostatic pressure:</p>
<div class="math notranslate nohighlight" id="eq-34">
<span id="equation-eq-34"></span><span class="eqno">(34)<a class="headerlink" href="#eq-34" title="Permalink to this equation"></a></span>\[ p= \alpha_1 \frac{1}{\lambda_1^{2} \lambda_2^{2}}+\alpha_{-1}\lambda_1^{2} \lambda_2^{2}\]</div>
<p>We can find <span class="math notranslate nohighlight">\(\alpha_1\)</span> and <span class="math notranslate nohighlight">\(\alpha_{-1}\)</span> : <span class="math notranslate nohighlight">\(\alpha_1=2c_1=\mu\)</span> and <span class="math notranslate nohighlight">\(\alpha_{-1}=0\)</span></p>
<p>By combining the <a class="reference internal" href="#eq-32"><span class="std std-ref">Equation.32</span></a> and <a class="reference internal" href="#eq-34"><span class="std std-ref">Equation.34</span></a>:</p>
<div class="math notranslate nohighlight" id="eq-35">
<span id="equation-eq-35"></span><span class="eqno">(35)<a class="headerlink" href="#eq-35" title="Permalink to this equation"></a></span>\[ \sigma_{ii}= \mu \lambda_{i}^2-\mu (\frac {1}{\lambda_i^{2}\lambda_i^{2}})\]</div>
<p>Which is same as <a class="reference internal" href="#eq-31"><span class="std std-ref">Equation.31</span></a>.</p>
</div>
</section>
<section id="finite-element-implementation">
<h3>1.2.2 Finite Element Implementation<a class="headerlink" href="#finite-element-implementation" title="Permalink to this heading"></a></h3>
<p>For the fully incompressible Neo-Hookean material the Jacobian of the deformation gradient
tensor is unity (e.g. <span class="math notranslate nohighlight">\(J=1\)</span>). The strain energy function is defined as follows:</p>
<div class="math notranslate nohighlight" id="eq-36">
<span id="equation-eq-36"></span><span class="eqno">(36)<a class="headerlink" href="#eq-36" title="Permalink to this equation"></a></span>\[ W= c_1(I_1-3)+p(J-1)\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the above equation, the parameter <span class="math notranslate nohighlight">\(p\)</span> is <strong>Lagrange Multiplier</strong> enforcing the fully incompressibility condition</p>
</div>
<p>The stress is defined:</p>
<div class="math notranslate nohighlight" id="eq-37">
<span id="equation-eq-37"></span><span class="eqno">(37)<a class="headerlink" href="#eq-37" title="Permalink to this equation"></a></span>\[ \sigma=\alpha_1 b + \alpha_{-1} b^{-1} - p I\]</div>
<p>Then the stress term is reduced to:</p>
<div class="math notranslate nohighlight" id="eq-38">
<span id="equation-eq-38"></span><span class="eqno">(38)<a class="headerlink" href="#eq-38" title="Permalink to this equation"></a></span>\[ \sigma=\mu b - p I\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When we solve for a fully incompressible material, we should define our problem on a mixed space including a scalar space (to solve for the <span class="math notranslate nohighlight">\(p\)</span>) and a vector space (to solve for the displacement)</p>
</div>
<p>The analytical solution for the uniaxial stretch for different shear modulus could be obtained using this code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lamda</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.15</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.25</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.35</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.45</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.55</span><span class="p">,</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.65</span><span class="p">,</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">0.75</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.85</span><span class="p">,</span><span class="mf">0.9</span><span class="p">,</span><span class="mf">0.95</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.25</span><span class="p">,</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">1.75</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mf">2.25</span><span class="p">,</span><span class="mf">2.5</span><span class="p">,</span><span class="mf">2.75</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">3.25</span><span class="p">,</span><span class="mf">3.5</span><span class="p">,</span><span class="mf">3.75</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mf">4.25</span><span class="p">,</span><span class="mf">4.5</span><span class="p">,</span><span class="mf">4.47</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>

<span class="c1"># Shear modulus = 0.5 MPa</span>
<span class="n">sigma_05</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># Shear modulus = 1.5 MPa</span>
<span class="n">sigma_15</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># Shear modulus = 3.5 MPa</span>
<span class="n">sigma_35</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lamda</span><span class="p">)):</span>

        <span class="n">a</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="n">lamda</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1.</span> <span class="o">/</span><span class="p">(</span><span class="n">lamda</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
        <span class="n">b</span> <span class="o">=</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="n">lamda</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1.</span> <span class="o">/</span><span class="p">(</span><span class="n">lamda</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
        <span class="n">c</span> <span class="o">=</span> <span class="mf">3.5</span> <span class="o">*</span> <span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="n">lamda</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1.</span> <span class="o">/</span><span class="p">(</span><span class="n">lamda</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>

        <span class="n">sigma_05</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="n">sigma_15</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
        <span class="n">sigma_35</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">sigma_05</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathrm</span><span class="si">{Stretch}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathrm{\sigma_</span><span class="si">{xx}</span><span class="s1">(MPa)}$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lamda</span><span class="p">,</span><span class="n">sigma_05</span><span class="p">,</span>  <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;maroon&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$(\mu=0.5)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lamda</span><span class="p">,</span><span class="n">sigma_15</span><span class="p">,</span>  <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$(\mu=1.5)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lamda</span><span class="p">,</span><span class="n">sigma_35</span><span class="p">,</span>  <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;teal&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$(\mu=3.5)$&#39;</span><span class="p">)</span>
<span class="n">lg</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">ncol</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">30</span><span class="p">])</span>

<span class="n">axes</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">35</span><span class="p">])</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>The implementation in FEniCS is presented in this code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dolfin</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1"># Defining Stretches</span>
<span class="n">stretch</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.15</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.25</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.35</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.45</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.55</span><span class="p">,</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.65</span><span class="p">,</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">0.75</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.85</span><span class="p">,</span><span class="mf">0.9</span><span class="p">,</span><span class="mf">0.95</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.25</span><span class="p">,</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">1.75</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mf">2.25</span><span class="p">,</span><span class="mf">2.5</span><span class="p">,</span><span class="mf">2.75</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">3.25</span><span class="p">,</span><span class="mf">3.5</span><span class="p">,</span><span class="mf">3.75</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mf">4.25</span><span class="p">,</span><span class="mf">4.5</span><span class="p">,</span><span class="mf">4.47</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
<span class="n">BC</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">stretch</span><span class="p">)):</span>
              <span class="n">N</span> <span class="o">=</span> <span class="n">stretch</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">-</span> <span class="mf">1.0</span>
              <span class="n">BC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

<span class="n">tol</span> <span class="o">=</span> <span class="mf">1E-14</span>
<span class="c1"># Define boundaries</span>
<span class="k">def</span> <span class="nf">FRONT</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">on_boundary</span><span class="p">):</span>
              <span class="k">return</span> <span class="n">on_boundary</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tol</span>


<span class="c1"># Defining the mesh which is a single hexahedron element</span>
<span class="n">mesh</span> <span class="o">=</span> <span class="n">UnitCubeMesh</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">CellType</span><span class="o">.</span><span class="n">Type</span><span class="o">.</span><span class="n">hexahedron</span><span class="p">)</span>

<span class="c1">############################################</span>
<span class="c1">#element for pressure field</span>
<span class="n">Element1</span> <span class="o">=</span> <span class="n">FiniteElement</span><span class="p">(</span><span class="s2">&quot;CG&quot;</span><span class="p">,</span> <span class="n">mesh</span><span class="o">.</span><span class="n">ufl_cell</span><span class="p">(),</span> <span class="mi">1</span><span class="p">)</span>
<span class="c1">#element for displacement field</span>
<span class="n">Element2</span> <span class="o">=</span> <span class="n">VectorElement</span><span class="p">(</span><span class="s2">&quot;CG&quot;</span><span class="p">,</span> <span class="n">mesh</span><span class="o">.</span><span class="n">ufl_cell</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># Defining the mixed function space</span>
<span class="n">W_elem</span> <span class="o">=</span> <span class="n">MixedElement</span><span class="p">([</span><span class="n">Element1</span><span class="p">,</span> <span class="n">Element2</span><span class="p">])</span>
<span class="n">W</span> <span class="o">=</span> <span class="n">FunctionSpace</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">W_elem</span><span class="p">)</span>
<span class="c1">#############################################</span>

<span class="n">boundaries</span> <span class="o">=</span> <span class="n">MeshFunction</span><span class="p">(</span><span class="s1">&#39;size_t&#39;</span><span class="p">,</span> <span class="n">mesh</span><span class="p">,</span> <span class="n">mesh</span><span class="o">.</span><span class="n">topology</span><span class="p">()</span><span class="o">.</span><span class="n">dim</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">subdomains</span> <span class="o">=</span> <span class="n">MeshFunction</span><span class="p">(</span><span class="s1">&#39;size_t&#39;</span><span class="p">,</span> <span class="n">mesh</span><span class="p">,</span> <span class="n">mesh</span><span class="o">.</span><span class="n">topology</span><span class="p">()</span><span class="o">.</span><span class="n">dim</span><span class="p">())</span>


<span class="c1"># Defining integration symbols</span>
<span class="n">dx</span> <span class="o">=</span> <span class="n">Measure</span><span class="p">(</span><span class="s1">&#39;dx&#39;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">mesh</span><span class="p">,</span> <span class="n">subdomain_data</span><span class="o">=</span><span class="n">subdomains</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;quadrature_degree&#39;</span><span class="p">:</span> <span class="mi">15</span><span class="p">})</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">Measure</span><span class="p">(</span><span class="s1">&#39;ds&#39;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">mesh</span><span class="p">,</span> <span class="n">subdomain_data</span><span class="o">=</span><span class="n">boundaries</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;quadrature_degree&#39;</span><span class="p">:</span> <span class="mi">15</span><span class="p">})</span>


<span class="c1">## Define variational problem</span>
<span class="n">dw</span> <span class="o">=</span> <span class="n">TrialFunction</span><span class="p">(</span><span class="n">W</span><span class="p">)</span>            <span class="c1"># Incremental displacement</span>
<span class="n">v</span>  <span class="o">=</span> <span class="n">TestFunction</span><span class="p">(</span><span class="n">W</span><span class="p">)</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="n">W</span><span class="p">)</span>
<span class="n">p</span><span class="p">,</span><span class="n">u</span> <span class="o">=</span> <span class="n">split</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>

<span class="c1">#Definig some continuum mechanics relations</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">geometric_dimension</span><span class="p">()</span>
<span class="n">I</span> <span class="o">=</span> <span class="n">Identity</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>             <span class="c1"># Identity tensor</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">I</span> <span class="o">+</span> <span class="n">grad</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>             <span class="c1"># Deformation gradient</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">T</span><span class="o">*</span><span class="n">F</span>                   <span class="c1"># Right cauchy stress tensor</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">F</span><span class="o">*</span><span class="n">F</span><span class="o">.</span><span class="n">T</span>                   <span class="c1"># Left cauchy stress tensor</span>
<span class="n">Ib</span> <span class="o">=</span> <span class="n">tr</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>                  <span class="c1"># First invariant of b tensor</span>
<span class="n">J</span>  <span class="o">=</span> <span class="n">det</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>                 <span class="c1"># Jacobian of deformation gradient tensor</span>

<span class="c1"># Shear modulus</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">0.5e6</span>

<span class="c1"># Strain energy function for fully incompressible model</span>
<span class="n">psi</span> <span class="o">=</span> <span class="n">mu</span><span class="o">/</span><span class="mf">2.</span><span class="o">*</span><span class="p">(</span><span class="n">Ib</span> <span class="o">-</span> <span class="mf">3.</span><span class="p">)</span><span class="o">*</span><span class="n">dx</span> <span class="o">-</span> <span class="n">p</span><span class="o">*</span><span class="p">(</span><span class="n">J</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">dx</span>

<span class="c1"># Gateaux derivative in the direction of the test function</span>
<span class="n">F1</span> <span class="o">=</span> <span class="n">derivative</span><span class="p">(</span><span class="n">psi</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">TestFunction</span><span class="p">(</span><span class="n">W</span><span class="p">))</span>

<span class="c1"># Compute Jacobian of F</span>
<span class="n">Jac</span> <span class="o">=</span> <span class="n">derivative</span><span class="p">(</span><span class="n">F1</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">TrialFunction</span><span class="p">(</span><span class="n">W</span><span class="p">))</span>

<span class="n">sigma_11</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">def</span> <span class="nf">border</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">on_boundary</span><span class="p">):</span>
              <span class="k">return</span> <span class="n">on_boundary</span>

<span class="n">bound_x</span> <span class="o">=</span>  <span class="n">Expression</span><span class="p">((</span><span class="s2">&quot;t*x[0]&quot;</span><span class="p">),</span> <span class="n">degree</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">BC</span><span class="p">)):</span>

              <span class="n">bound_x</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">BC</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

              <span class="n">bc_x</span> <span class="o">=</span> <span class="n">DirichletBC</span><span class="p">(</span><span class="n">W</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">bound_x</span><span class="p">,</span> <span class="n">border</span><span class="p">)</span>
              <span class="n">bc_front</span> <span class="o">=</span> <span class="n">DirichletBC</span><span class="p">(</span><span class="n">W</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">Constant</span><span class="p">((</span><span class="mi">0</span><span class="p">)),</span> <span class="n">FRONT</span><span class="p">)</span>

              <span class="n">bc_all</span> <span class="o">=</span> <span class="p">[</span><span class="n">bc_x</span><span class="p">,</span><span class="n">bc_front</span><span class="p">]</span>

              <span class="n">problem</span> <span class="o">=</span> <span class="n">NonlinearVariationalProblem</span><span class="p">(</span><span class="n">F1</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">bc_all</span><span class="p">,</span> <span class="n">Jac</span><span class="p">)</span>

              <span class="n">solver</span> <span class="o">=</span> <span class="n">NonlinearVariationalSolver</span><span class="p">(</span><span class="n">problem</span><span class="p">)</span>

              <span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>

              <span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1">#Stress calculation</span>
              <span class="n">sig</span> <span class="o">=</span> <span class="n">mu</span> <span class="o">*</span> <span class="n">b</span> <span class="o">-</span> <span class="n">p</span> <span class="o">*</span> <span class="n">I</span>
<span class="c1"># Defining a tenso function space</span>
              <span class="n">V</span> <span class="o">=</span> <span class="n">TensorFunctionSpace</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s1">&#39;Lagrange&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="c1"># Projection of the stress on the tensor function space</span>
              <span class="n">sig1</span> <span class="o">=</span> <span class="n">project</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="n">V</span><span class="p">)</span>

              <span class="n">sigma_11</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">sig1</span><span class="o">.</span><span class="n">vector</span><span class="p">()</span><span class="o">.</span><span class="n">get_local</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="mf">0.000001</span><span class="p">)</span>

<span class="nb">print</span> <span class="p">(</span><span class="n">sigma_11</span><span class="p">)</span>

<span class="c1">#Obtained reaults for mu = 0.5 MPa#</span>
<span class="n">sigma_05</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">3.3220833333333144</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.4800000000022377</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.968750000000018</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.6216666666666604</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.3673214285714232</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.1699999999999993</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0098611111111104</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8749999999999992</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7578409090909061</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6533333334279298</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5579807692745585</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4692857143072567</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3854166666778288</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3050000000060496</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2269852941210564</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.15055555555754435</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.07506578947488027</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.390848180406038e-13</span><span class="p">,</span> <span class="mf">0.38124999999999554</span><span class="p">,</span> <span class="mf">0.7916666666666644</span><span class="p">,</span> <span class="mf">1.2455357142857126</span><span class="p">,</span> <span class="mf">1.7499999999999942</span><span class="p">,</span> <span class="mf">2.309027777777776</span><span class="p">,</span> <span class="mf">2.924999999888631</span><span class="p">,</span> <span class="mf">3.5994318181378744</span><span class="p">,</span> <span class="mf">4.333333333314409</span><span class="p">,</span> <span class="mf">5.12740384614507</span><span class="p">,</span> <span class="mf">5.982142857138549</span><span class="p">,</span> <span class="mf">6.897916666664428</span><span class="p">,</span> <span class="mf">7.874999999998786</span><span class="p">,</span> <span class="mf">8.913602941175803</span><span class="p">,</span> <span class="mf">10.013888888888484</span><span class="p">,</span> <span class="mf">9.878593176733789</span><span class="p">,</span> <span class="mf">12.399999999906841</span><span class="p">]</span>

<span class="c1">#Obtained reaults for mu = 1.5 MPa#</span>
<span class="n">sigma_15</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">9.966249999999953</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.4400000000052655</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.906250000000058</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.864999999999997</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.101964285714497</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.50999999999999</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.029583333333331</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.624999999999993</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.2735227272727245</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.9599999999999933</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.6739423078102886</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.4078571429217734</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.1562500000334857</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.9150000000181479</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6809558823631715</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.45166666667263133</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2251973684246401</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.217263493368278e-12</span><span class="p">,</span> <span class="mf">1.1437499999999825</span><span class="p">,</span> <span class="mf">2.3749999999999947</span><span class="p">,</span> <span class="mf">3.7366071428571317</span><span class="p">,</span> <span class="mf">5.250000000116358</span><span class="p">,</span> <span class="mf">6.927083333333332</span><span class="p">,</span> <span class="mf">8.774999999844844</span><span class="p">,</span> <span class="mf">10.798295454413642</span><span class="p">,</span> <span class="mf">12.999999999943254</span><span class="p">,</span> <span class="mf">15.382211538435248</span><span class="p">,</span> <span class="mf">17.94642857141561</span><span class="p">,</span> <span class="mf">20.69374999999328</span><span class="p">,</span> <span class="mf">23.624999999996415</span><span class="p">,</span> <span class="mf">26.740808823527377</span><span class="p">,</span> <span class="mf">30.04166666666549</span><span class="p">,</span> <span class="mf">29.63577953020131</span><span class="p">,</span> <span class="mf">37.19999999983032</span><span class="p">]</span>

<span class="c1">#Obtained reaults for mu = 3.5 MPa#</span>
<span class="n">sigma_35</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">23.254583333333265</span><span class="p">,</span> <span class="o">-</span><span class="mf">17.360000000015262</span><span class="p">,</span> <span class="o">-</span><span class="mf">13.781250000000021</span><span class="p">,</span> <span class="o">-</span><span class="mf">11.351666666666649</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.571249999999983</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.189999999999996</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.069027777155056</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.124999999999978</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.304886363636268</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.573333333994748</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.9058653849219174</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.285000000150805</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.697916666744805</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.1350000000423432</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5888970588473983</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0538888889028104</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5254605263241604</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.173676343700641e-12</span><span class="p">,</span> <span class="mf">2.6687499999999695</span><span class="p">,</span> <span class="mf">5.5416666666666545</span><span class="p">,</span> <span class="mf">8.718749999880098</span><span class="p">,</span> <span class="mf">12.249999999999975</span><span class="p">,</span> <span class="mf">16.163194443414437</span><span class="p">,</span> <span class="mf">20.47499999922037</span><span class="p">,</span> <span class="mf">25.19602272696517</span><span class="p">,</span> <span class="mf">30.333333333200915</span><span class="p">,</span> <span class="mf">35.89182692301562</span><span class="p">,</span> <span class="mf">41.874999999969944</span><span class="p">,</span> <span class="mf">48.28541666665088</span><span class="p">,</span> <span class="mf">55.1249999999915</span><span class="p">,</span> <span class="mf">62.39522058823055</span><span class="p">,</span> <span class="mf">70.09722222221926</span><span class="p">,</span> <span class="mf">69.15015223713617</span><span class="p">,</span> <span class="mf">86.79999999993669</span><span class="p">]</span>

<span class="c1">#Plotting the Results#</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathrm</span><span class="si">{Stretch}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathrm{\sigma_</span><span class="si">{xx}</span><span class="s1">(MPa)}$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">stretch</span><span class="p">,</span><span class="n">sigma_05</span><span class="p">,</span>  <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$(\mu=0.5\/\/MPa)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">stretch</span><span class="p">,</span><span class="n">sigma_15</span><span class="p">,</span>  <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$(\mu=1.5\/\/MPa)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">stretch</span><span class="p">,</span><span class="n">sigma_35</span><span class="p">,</span>  <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$(\mu=3.5\/\/MPa)$&#39;</span><span class="p">)</span>
<span class="n">lg</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">ncol</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">30</span><span class="p">])</span>

<span class="n">axes</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">35</span><span class="p">])</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>The results of analytical solution and finite element implementation are compared in
figure.1:</p>
<figure class="align-center" id="id9">
<img alt="../_images/1.png" src="../_images/1.png" />
<figcaption>
<p><span class="caption-number">Fig. 1 </span><span class="caption-text">The stress results for the fully incompressible material model in uniaxial loading - Finite Element (Right) vs Analytical (Left)</span><a class="headerlink" href="#id9" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>The analytical solution for the Biaxial stretch for different shear modulus could be obtained using the code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lamda</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.15</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.25</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.35</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.45</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.55</span><span class="p">,</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.65</span><span class="p">,</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">0.75</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.85</span><span class="p">,</span><span class="mf">0.9</span><span class="p">,</span><span class="mf">0.95</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.25</span><span class="p">,</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">1.75</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mf">2.25</span><span class="p">,</span><span class="mf">2.5</span><span class="p">,</span><span class="mf">2.75</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">3.25</span><span class="p">,</span><span class="mf">3.5</span><span class="p">,</span><span class="mf">3.75</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mf">4.25</span><span class="p">,</span><span class="mf">4.5</span><span class="p">,</span><span class="mf">4.47</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>

<span class="c1"># Shear modulus = 0.5 MPa</span>
<span class="n">sigma_05</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># Shear modulus = 1.5 MPa</span>
<span class="n">sigma_15</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># Shear modulus = 3.5 MPa</span>
<span class="n">sigma_35</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lamda</span><span class="p">)):</span>

        <span class="n">a</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="n">lamda</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1.</span> <span class="o">/</span><span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="n">lamda</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="mi">4</span><span class="p">)))</span>
        <span class="n">b</span> <span class="o">=</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="n">lamda</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1.</span> <span class="o">/</span> <span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="n">lamda</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">4</span><span class="p">)))</span>
        <span class="n">c</span> <span class="o">=</span> <span class="mf">3.5</span> <span class="o">*</span> <span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="n">lamda</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1.</span> <span class="o">/</span> <span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="n">lamda</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">4</span><span class="p">)))</span>

        <span class="n">sigma_05</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="n">sigma_15</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
        <span class="n">sigma_35</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>


<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">sigma_05</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathrm</span><span class="si">{Stretch}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathrm{\sigma_</span><span class="si">{xx}</span><span class="s1">=\sigma_</span><span class="si">{yy}</span><span class="s1">\/\/(MPa)}$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lamda</span><span class="p">,</span><span class="n">sigma_05</span><span class="p">,</span>  <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lime&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$(\mu=0.5)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lamda</span><span class="p">,</span><span class="n">sigma_15</span><span class="p">,</span>  <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$(\mu=1.5)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lamda</span><span class="p">,</span><span class="n">sigma_35</span><span class="p">,</span>  <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$(\mu=3.5)$&#39;</span><span class="p">)</span>
<span class="n">lg</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">ncol</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">35</span><span class="p">])</span>

<span class="n">axes</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">35</span><span class="p">])</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>And similarly the implmentation of the FEM code in FEniCS is presented here:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dolfin</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1"># Defining Stretches</span>
<span class="n">stretch</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.15</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.25</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.35</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.45</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.55</span><span class="p">,</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.65</span><span class="p">,</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">0.75</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.85</span><span class="p">,</span><span class="mf">0.9</span><span class="p">,</span><span class="mf">0.95</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.25</span><span class="p">,</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">1.75</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mf">2.25</span><span class="p">,</span><span class="mf">2.5</span><span class="p">,</span><span class="mf">2.75</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">3.25</span><span class="p">,</span><span class="mf">3.5</span><span class="p">,</span><span class="mf">3.75</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mf">4.25</span><span class="p">,</span><span class="mf">4.5</span><span class="p">,</span><span class="mf">4.47</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
<span class="n">BC</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">stretch</span><span class="p">)):</span>
         <span class="n">N</span> <span class="o">=</span> <span class="n">stretch</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">-</span> <span class="mf">1.0</span>
         <span class="n">BC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

<span class="n">tol</span> <span class="o">=</span> <span class="mf">1E-14</span>
<span class="c1"># Define boundaries</span>
<span class="k">def</span> <span class="nf">LEFT</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">on_boundary</span><span class="p">):</span>
         <span class="k">return</span> <span class="n">on_boundary</span> <span class="ow">and</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">tol</span>

<span class="k">def</span> <span class="nf">RIGHT</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">on_boundary</span><span class="p">):</span>
         <span class="k">return</span> <span class="n">on_boundary</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tol</span>

<span class="k">def</span> <span class="nf">BOTTOM</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">on_boundary</span><span class="p">):</span>
         <span class="k">return</span> <span class="n">on_boundary</span> <span class="ow">and</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">tol</span>

<span class="k">def</span> <span class="nf">TOP</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">on_boundary</span><span class="p">):</span>
         <span class="k">return</span> <span class="n">on_boundary</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tol</span>

<span class="k">def</span> <span class="nf">FRONT</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">on_boundary</span><span class="p">):</span>
         <span class="k">return</span> <span class="n">on_boundary</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tol</span>

<span class="k">def</span> <span class="nf">BACK</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">on_boundary</span><span class="p">):</span>
         <span class="k">return</span> <span class="n">on_boundary</span> <span class="ow">and</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">tol</span>

<span class="c1"># Defining the mesh which is a single hexahedron element</span>
<span class="n">mesh</span> <span class="o">=</span> <span class="n">UnitCubeMesh</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">CellType</span><span class="o">.</span><span class="n">Type</span><span class="o">.</span><span class="n">hexahedron</span><span class="p">)</span>


<span class="c1">#element for pressure field</span>
<span class="n">Element1</span> <span class="o">=</span> <span class="n">FiniteElement</span><span class="p">(</span><span class="s2">&quot;CG&quot;</span><span class="p">,</span> <span class="n">mesh</span><span class="o">.</span><span class="n">ufl_cell</span><span class="p">(),</span> <span class="mi">1</span><span class="p">)</span>
<span class="c1">#element for displacement field</span>
<span class="n">Element2</span> <span class="o">=</span> <span class="n">VectorElement</span><span class="p">(</span><span class="s2">&quot;CG&quot;</span><span class="p">,</span> <span class="n">mesh</span><span class="o">.</span><span class="n">ufl_cell</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># Defining the mixed function space</span>
<span class="n">W_elem</span> <span class="o">=</span> <span class="n">MixedElement</span><span class="p">([</span><span class="n">Element1</span><span class="p">,</span> <span class="n">Element2</span><span class="p">])</span>
<span class="n">W</span> <span class="o">=</span> <span class="n">FunctionSpace</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">W_elem</span><span class="p">)</span>
<span class="c1">#############################################</span>

<span class="n">boundaries</span> <span class="o">=</span> <span class="n">MeshFunction</span><span class="p">(</span><span class="s1">&#39;size_t&#39;</span><span class="p">,</span> <span class="n">mesh</span><span class="p">,</span> <span class="n">mesh</span><span class="o">.</span><span class="n">topology</span><span class="p">()</span><span class="o">.</span><span class="n">dim</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">subdomains</span> <span class="o">=</span> <span class="n">MeshFunction</span><span class="p">(</span><span class="s1">&#39;size_t&#39;</span><span class="p">,</span> <span class="n">mesh</span><span class="p">,</span> <span class="n">mesh</span><span class="o">.</span><span class="n">topology</span><span class="p">()</span><span class="o">.</span><span class="n">dim</span><span class="p">())</span>


<span class="c1"># Defining integration symbols</span>
<span class="n">dx</span> <span class="o">=</span> <span class="n">Measure</span><span class="p">(</span><span class="s1">&#39;dx&#39;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">mesh</span><span class="p">,</span> <span class="n">subdomain_data</span><span class="o">=</span><span class="n">subdomains</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;quadrature_degree&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">Measure</span><span class="p">(</span><span class="s1">&#39;ds&#39;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">mesh</span><span class="p">,</span> <span class="n">subdomain_data</span><span class="o">=</span><span class="n">boundaries</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;quadrature_degree&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>


<span class="c1">## Define variational problem</span>
<span class="n">dw</span> <span class="o">=</span> <span class="n">TrialFunction</span><span class="p">(</span><span class="n">W</span><span class="p">)</span>            <span class="c1"># Incremental displacement</span>
<span class="n">v</span>  <span class="o">=</span> <span class="n">TestFunction</span><span class="p">(</span><span class="n">W</span><span class="p">)</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="n">W</span><span class="p">)</span>
<span class="n">p</span><span class="p">,</span><span class="n">u</span> <span class="o">=</span> <span class="n">split</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>

<span class="c1">#Definig some continuum mechanics relations</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">geometric_dimension</span><span class="p">()</span>
<span class="n">I</span> <span class="o">=</span> <span class="n">Identity</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>             <span class="c1"># Identity tensor</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">I</span> <span class="o">+</span> <span class="n">grad</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>             <span class="c1"># Deformation gradient</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">T</span><span class="o">*</span><span class="n">F</span>                   <span class="c1"># Right cauchy stress tensor</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">F</span><span class="o">*</span><span class="n">F</span><span class="o">.</span><span class="n">T</span>                   <span class="c1"># Left cauchy stress tensor</span>
<span class="n">Ib</span> <span class="o">=</span> <span class="n">tr</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>                  <span class="c1"># First invariant of b tensor</span>
<span class="n">J</span>  <span class="o">=</span> <span class="n">det</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>                 <span class="c1"># Jacobian of deformation gradient tensor</span>

<span class="c1"># Shear modulus</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">3.5e6</span>

<span class="c1"># Strain energy function for fully incompressible model</span>
<span class="n">psi</span> <span class="o">=</span> <span class="n">mu</span><span class="o">/</span><span class="mf">2.</span><span class="o">*</span><span class="p">(</span><span class="n">Ib</span> <span class="o">-</span> <span class="mf">3.</span><span class="p">)</span><span class="o">*</span><span class="n">dx</span> <span class="o">-</span> <span class="n">p</span><span class="o">*</span><span class="p">(</span><span class="n">J</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">dx</span>

<span class="c1"># Gateaux derivative in the direction of the test function</span>
<span class="n">F1</span> <span class="o">=</span> <span class="n">derivative</span><span class="p">(</span><span class="n">psi</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">TestFunction</span><span class="p">(</span><span class="n">W</span><span class="p">))</span>

<span class="c1"># Compute Jacobian of F</span>
<span class="n">Jac</span> <span class="o">=</span> <span class="n">derivative</span><span class="p">(</span><span class="n">F1</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">TrialFunction</span><span class="p">(</span><span class="n">W</span><span class="p">))</span>

<span class="n">sigma_11</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">sigma_22</span> <span class="o">=</span> <span class="p">[]</span>


<span class="k">def</span> <span class="nf">border</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">on_boundary</span><span class="p">):</span>
         <span class="k">return</span> <span class="n">on_boundary</span>

<span class="n">bound_x</span> <span class="o">=</span>  <span class="n">Expression</span><span class="p">((</span><span class="s2">&quot;t*x[0]&quot;</span><span class="p">),</span> <span class="n">degree</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">bound_y</span> <span class="o">=</span>  <span class="n">Expression</span><span class="p">((</span><span class="s2">&quot;t*x[1]&quot;</span><span class="p">),</span> <span class="n">degree</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">BC</span><span class="p">)):</span>

         <span class="n">bound_x</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">BC</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
         <span class="n">bound_y</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">BC</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

         <span class="n">bc_x</span> <span class="o">=</span> <span class="n">DirichletBC</span><span class="p">(</span><span class="n">W</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">bound_x</span><span class="p">,</span> <span class="n">border</span><span class="p">)</span>
         <span class="n">bc_y</span> <span class="o">=</span> <span class="n">DirichletBC</span><span class="p">(</span><span class="n">W</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">bound_y</span><span class="p">,</span> <span class="n">border</span><span class="p">)</span>
         <span class="n">bc_front</span> <span class="o">=</span> <span class="n">DirichletBC</span><span class="p">(</span><span class="n">W</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">Constant</span><span class="p">((</span><span class="mi">0</span><span class="p">)),</span> <span class="n">FRONT</span><span class="p">)</span>

         <span class="n">bc_all</span> <span class="o">=</span> <span class="p">[</span><span class="n">bc_x</span><span class="p">,</span><span class="n">bc_y</span><span class="p">,</span><span class="n">bc_front</span><span class="p">]</span>

         <span class="n">problem</span> <span class="o">=</span> <span class="n">NonlinearVariationalProblem</span><span class="p">(</span><span class="n">F1</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">bc_all</span><span class="p">,</span> <span class="n">Jac</span><span class="p">)</span>

         <span class="n">solver</span> <span class="o">=</span> <span class="n">NonlinearVariationalSolver</span><span class="p">(</span><span class="n">problem</span><span class="p">)</span>

         <span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>

         <span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1">#Stress calculation</span>
         <span class="n">sig</span> <span class="o">=</span> <span class="n">mu</span> <span class="o">*</span> <span class="n">b</span> <span class="o">-</span> <span class="n">p</span> <span class="o">*</span> <span class="n">I</span>
<span class="c1"># Defining a tensor function space</span>
         <span class="n">Vv</span> <span class="o">=</span> <span class="n">TensorFunctionSpace</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s1">&#39;Lagrange&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="c1"># Projection of the stress on the tensor function space</span>
         <span class="n">sig1</span> <span class="o">=</span> <span class="n">project</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="n">Vv</span><span class="p">)</span>

         <span class="n">sigma_11</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">sig1</span><span class="o">.</span><span class="n">vector</span><span class="p">()</span><span class="o">.</span><span class="n">get_local</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="mf">0.000001</span><span class="p">)</span>

<span class="nb">print</span> <span class="p">(</span><span class="n">sigma_11</span><span class="p">)</span>

<span class="c1">#Obtained reaults for mu = 0.5 MPa#</span>
<span class="n">sigma_05</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">987.6430709876522</span><span class="p">,</span> <span class="o">-</span><span class="mf">312.4800000000002</span><span class="p">,</span> <span class="o">-</span><span class="mf">127.96874999999937</span><span class="p">,</span> <span class="o">-</span><span class="mf">61.68339506172817</span><span class="p">,</span> <span class="o">-</span><span class="mf">33.258200229071136</span><span class="p">,</span> <span class="o">-</span><span class="mf">19.451249999999895</span><span class="p">,</span> <span class="o">-</span><span class="mf">12.092013222069799</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.8750000000000036</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.31285764292055</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.678024691358014</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.589772373166203</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.8374656393169522</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.2989969135802488</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.9007031249999968</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5965929377042906</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.35707895137936096</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.16261883157741178</span><span class="p">,</span> <span class="mf">8.145274061386054e-17</span><span class="p">,</span> <span class="mf">0.5764499999999999</span><span class="p">,</span> <span class="mf">1.0262345679012317</span><span class="p">,</span> <span class="mf">1.477938879633484</span><span class="p">,</span> <span class="mf">1.9687500000000013</span><span class="p">,</span> <span class="mf">2.5117407788446906</span><span class="p">,</span> <span class="mf">3.1121999999999943</span><span class="p">,</span> <span class="mf">3.772507427771319</span><span class="p">,</span> <span class="mf">4.4938271604938125</span><span class="p">,</span> <span class="mf">5.276768364202937</span><span class="p">,</span> <span class="mf">6.121668054977084</span><span class="p">,</span> <span class="mf">7.028721604938255</span><span class="p">,</span> <span class="mf">7.99804687499999</span><span class="p">,</span> <span class="mf">9.029717451299652</span><span class="p">,</span> <span class="mf">10.12378067367779</span><span class="p">,</span> <span class="mf">9.989197609075557</span><span class="p">,</span> <span class="mf">12.499199999999991</span><span class="p">]</span>

<span class="c1">#Obtained reaults for mu = 0.5 MPa#</span>
<span class="n">sigma_15</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">2962.92921296296</span><span class="p">,</span> <span class="o">-</span><span class="mf">937.4399999999958</span><span class="p">,</span> <span class="o">-</span><span class="mf">383.90625000000057</span><span class="p">,</span> <span class="o">-</span><span class="mf">185.0501851851853</span><span class="p">,</span> <span class="o">-</span><span class="mf">99.77460068721344</span><span class="p">,</span> <span class="o">-</span><span class="mf">58.3537499999997</span><span class="p">,</span> <span class="o">-</span><span class="mf">36.27603966620935</span><span class="p">,</span> <span class="o">-</span><span class="mf">23.624999999999954</span><span class="p">,</span> <span class="o">-</span><span class="mf">15.938572928761642</span><span class="p">,</span> <span class="o">-</span><span class="mf">11.034074074074056</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.769317119498598</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.512396917950832</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.8969907407407285</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.702109374999993</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.7897788131128693</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0712368541380837</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4878564947322365</span><span class="p">,</span> <span class="mf">3.805590898063224e-16</span><span class="p">,</span> <span class="mf">1.7293499999999953</span><span class="p">,</span> <span class="mf">3.0787037037036926</span><span class="p">,</span> <span class="mf">4.433816638900447</span><span class="p">,</span> <span class="mf">5.906249999999991</span><span class="p">,</span> <span class="mf">7.53522233653405</span><span class="p">,</span> <span class="mf">9.336599999999983</span><span class="p">,</span> <span class="mf">11.317522283314</span><span class="p">,</span> <span class="mf">13.48148148148149</span><span class="p">,</span> <span class="mf">15.830305092608764</span><span class="p">,</span> <span class="mf">18.365004164931293</span><span class="p">,</span> <span class="mf">21.08616481481487</span><span class="p">,</span> <span class="mf">23.994140624999996</span><span class="p">,</span> <span class="mf">27.089152353899063</span><span class="p">,</span> <span class="mf">30.371342021033435</span><span class="p">,</span> <span class="mf">29.967592827226596</span><span class="p">,</span> <span class="mf">37.49759999999998</span><span class="p">]</span>

<span class="c1">#Obtained reaults for mu = 0.5 MPa#</span>
<span class="n">sigma_35</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">6913.501496913527</span><span class="p">,</span> <span class="o">-</span><span class="mf">2187.3599999999847</span><span class="p">,</span> <span class="o">-</span><span class="mf">895.7812499999939</span><span class="p">,</span> <span class="o">-</span><span class="mf">431.78376543209447</span><span class="p">,</span> <span class="o">-</span><span class="mf">232.8074016034988</span><span class="p">,</span> <span class="o">-</span><span class="mf">136.15874999999932</span><span class="p">,</span> <span class="o">-</span><span class="mf">84.6440925544885</span><span class="p">,</span> <span class="o">-</span><span class="mf">55.12499999999978</span><span class="p">,</span> <span class="o">-</span><span class="mf">37.19000350044388</span><span class="p">,</span> <span class="o">-</span><span class="mf">25.746172839506176</span><span class="p">,</span> <span class="o">-</span><span class="mf">18.128406612163456</span><span class="p">,</span> <span class="o">-</span><span class="mf">12.862259475218625</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.092978395061715</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.304921874999984</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.176150563930013</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.499552659655526</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.1383318210418847</span><span class="p">,</span> <span class="mf">6.882290512141593e-16</span><span class="p">,</span> <span class="mf">4.035149999999988</span><span class="p">,</span> <span class="mf">7.183641975308622</span><span class="p">,</span> <span class="mf">10.345572157434399</span><span class="p">,</span> <span class="mf">13.781249999999941</span><span class="p">,</span> <span class="mf">17.582185451912803</span><span class="p">,</span> <span class="mf">21.78539999999999</span><span class="p">,</span> <span class="mf">26.407551994399167</span><span class="p">,</span> <span class="mf">31.456790123456745</span><span class="p">,</span> <span class="mf">36.93737854942055</span><span class="p">,</span> <span class="mf">42.85167638483961</span><span class="p">,</span> <span class="mf">49.20105123456792</span><span class="p">,</span> <span class="mf">55.986328124999986</span><span class="p">,</span> <span class="mf">63.2080221590976</span><span class="p">,</span> <span class="mf">70.8664647157445</span><span class="p">,</span> <span class="mf">69.92438326352887</span><span class="p">,</span> <span class="mf">87.49440000000017</span><span class="p">]</span>

<span class="c1">#Plotting#</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="c1">#print (sigma_05)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathrm</span><span class="si">{Stretch}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathrm{\sigma_</span><span class="si">{xx}</span><span class="s1">=\sigma_</span><span class="si">{yy}</span><span class="s1">\/\/(MPa)}$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">stretch</span><span class="p">,</span><span class="n">sigma_05</span><span class="p">,</span>  <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$(\mu=0.5)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">stretch</span><span class="p">,</span><span class="n">sigma_15</span><span class="p">,</span>  <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$(\mu=1.5)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">stretch</span><span class="p">,</span><span class="n">sigma_35</span><span class="p">,</span>  <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;crimson&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$(\mu=3.5)$&#39;</span><span class="p">)</span>
<span class="n">lg</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">ncol</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">35</span><span class="p">])</span>

<span class="n">axes</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">35</span><span class="p">])</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-center" id="id10">
<img alt="../_images/2.png" src="../_images/2.png" />
<figcaption>
<p><span class="caption-number">Fig. 2 </span><span class="caption-text">The stress results for the fully incompressible material model in biaxial loading - Finite Element (Right) vs Analytical (Left)</span><a class="headerlink" href="#id10" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</section>
</section>
<section id="nearly-incompressible-model">
<h2>1.3. Nearly Incompressible Model<a class="headerlink" href="#nearly-incompressible-model" title="Permalink to this heading"></a></h2>
<section id="id1">
<h3>1.3.1. Constitutive Equations<a class="headerlink" href="#id1" title="Permalink to this heading"></a></h3>
<p>For the nearly incompressible Neo-Hookean material, the bulk modulus appears in the strain energy function. It should be noted that as the ratio <span class="math notranslate nohighlight">\(\frac{K}{\mu}`increases, the behavior of the material becomes closer to a fully incompressible material model (e.g. :math:`J\)</span> converges to unity).</p>
<p>The strain energy function is defined as:</p>
<div class="math notranslate nohighlight" id="eq-39">
<span id="equation-eq-39"></span><span class="eqno">(39)<a class="headerlink" href="#eq-39" title="Permalink to this equation"></a></span>\[ W=c_1(I_1-3)+ \frac{1}{2}K(Ln(J))^2\]</div>
<p>Where <span class="math notranslate nohighlight">\(I_1\)</span> corresponds to the first invariant of the <span class="math notranslate nohighlight">\(\tilde{C}\)</span> where <span class="math notranslate nohighlight">\(C=J^{\frac{-2}{3}}C\)</span>. The stress is defined as:</p>
<div class="math notranslate nohighlight" id="eq-40">
<span id="equation-eq-40"></span><span class="eqno">(40)<a class="headerlink" href="#eq-40" title="Permalink to this equation"></a></span>\[ \sigma=pI+ \frac{2}{J}[c_1 b - \frac{1}{3} (c_1 I_1)I]\]</div>
<p>In the above equation:</p>
<div class="math notranslate nohighlight" id="eq-41">
<span id="equation-eq-41"></span><span class="eqno">(41)<a class="headerlink" href="#eq-41" title="Permalink to this equation"></a></span>\[ p = K \frac{Ln(J)}{J}\]</div>
</section>
<section id="id2">
<h3>1.3.2 Finite Element Implementation<a class="headerlink" href="#id2" title="Permalink to this heading"></a></h3>
<p>The FEniCS implementation of the Neo-Hookean nearly incompressible material on a single hexahedron element under biaxial stretch is shown as below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dolfin</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;form_compiler&quot;</span><span class="p">][</span><span class="s2">&quot;representation&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;tsfc&quot;</span>

<span class="n">stretch</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.95</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.25</span><span class="p">,</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">1.75</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mf">2.25</span><span class="p">,</span><span class="mf">2.5</span><span class="p">,</span><span class="mf">2.75</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>

<span class="n">BC</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">stretch</span><span class="p">)):</span>
         <span class="n">N</span> <span class="o">=</span> <span class="n">stretch</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">-</span> <span class="mf">1.0</span>
         <span class="n">BC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

<span class="n">tol</span> <span class="o">=</span> <span class="mf">1E-14</span>

<span class="c1"># Define boundary</span>

<span class="k">def</span> <span class="nf">FRONT</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">on_boundary</span><span class="p">):</span>
         <span class="k">return</span> <span class="n">on_boundary</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tol</span>


<span class="n">mesh</span> <span class="o">=</span> <span class="n">UnitCubeMesh</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">CellType</span><span class="o">.</span><span class="n">Type</span><span class="o">.</span><span class="n">hexahedron</span><span class="p">)</span>

<span class="c1">############################################</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">VectorFunctionSpace</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s1">&#39;CG&#39;</span><span class="p">,</span> <span class="n">degree</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">du</span>  <span class="o">=</span> <span class="n">TrialFunction</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>           <span class="c1"># Trial function</span>
<span class="n">v</span>  <span class="o">=</span> <span class="n">TestFunction</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>             <span class="c1"># Test function</span>
<span class="n">u</span>  <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
<span class="c1">#############################################</span>

<span class="n">boundaries</span> <span class="o">=</span> <span class="n">MeshFunction</span><span class="p">(</span><span class="s1">&#39;size_t&#39;</span><span class="p">,</span> <span class="n">mesh</span><span class="p">,</span> <span class="n">mesh</span><span class="o">.</span><span class="n">topology</span><span class="p">()</span><span class="o">.</span><span class="n">dim</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">subdomains</span> <span class="o">=</span> <span class="n">MeshFunction</span><span class="p">(</span><span class="s1">&#39;size_t&#39;</span><span class="p">,</span> <span class="n">mesh</span><span class="p">,</span> <span class="n">mesh</span><span class="o">.</span><span class="n">topology</span><span class="p">()</span><span class="o">.</span><span class="n">dim</span><span class="p">())</span>


<span class="n">dx</span> <span class="o">=</span> <span class="n">Measure</span><span class="p">(</span><span class="s1">&#39;dx&#39;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">mesh</span><span class="p">,</span> <span class="n">subdomain_data</span><span class="o">=</span><span class="n">subdomains</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;quadrature_degree&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">Measure</span><span class="p">(</span><span class="s1">&#39;ds&#39;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">mesh</span><span class="p">,</span> <span class="n">subdomain_data</span><span class="o">=</span><span class="n">boundaries</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;quadrature_degree&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>


<span class="c1">#################</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">geometric_dimension</span><span class="p">()</span>
<span class="n">I</span> <span class="o">=</span> <span class="n">Identity</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>             <span class="c1"># Identity tensor</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">I</span> <span class="o">+</span> <span class="n">grad</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>             <span class="c1"># Deformation gradient</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">T</span><span class="o">*</span><span class="n">F</span>                   <span class="c1"># Right cauchy stress tensor</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">F</span><span class="o">*</span><span class="n">F</span><span class="o">.</span><span class="n">T</span>                   <span class="c1"># Left cauchy stress tensor</span>
<span class="n">Ic</span> <span class="o">=</span> <span class="n">tr</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
<span class="n">J</span>  <span class="o">=</span> <span class="n">det</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>                 <span class="c1"># Jacobian of deformation gradient tensor</span>
<span class="n">Ib</span> <span class="o">=</span> <span class="n">tr</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>                  <span class="c1"># First invariant of b tensor</span>

<span class="n">Ic_bar</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">J</span><span class="p">,</span><span class="o">-</span><span class="mf">2.</span><span class="o">/</span><span class="mf">3.</span><span class="p">)</span><span class="o">*</span><span class="n">Ic</span>
<span class="n">C_bar</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">J</span><span class="p">,</span><span class="o">-</span><span class="mf">2.</span><span class="o">/</span><span class="mf">3.</span><span class="p">)</span><span class="o">*</span><span class="n">C</span>
<span class="n">B_bar</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">J</span><span class="p">,</span><span class="o">-</span><span class="mf">2.</span><span class="o">/</span><span class="mf">3.</span><span class="p">)</span><span class="o">*</span><span class="n">b</span>

<span class="c1"># The bulk modulus (K) and shear modulus (mu) are defined here. Feel free to change them to see the effect of K/mu in the results</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">1.5E6</span>
<span class="n">K</span> <span class="o">=</span> <span class="mf">7.5E10</span>

<span class="n">psi</span> <span class="o">=</span> <span class="p">(</span><span class="n">mu</span><span class="o">/</span><span class="mf">2.</span> <span class="o">*</span> <span class="p">(</span><span class="n">Ic_bar</span> <span class="o">-</span> <span class="mf">3.</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">K</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">ln</span><span class="p">(</span><span class="n">J</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="n">dx</span>

<span class="n">F1</span> <span class="o">=</span> <span class="n">derivative</span><span class="p">(</span><span class="n">psi</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>

<span class="c1"># Compute Jacobian of F</span>
<span class="n">Jac</span> <span class="o">=</span> <span class="n">derivative</span><span class="p">(</span><span class="n">F1</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">du</span><span class="p">)</span>

<span class="n">sigma_11</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># Array for storing the stress in x direction</span>
<span class="n">sigma_22</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># Array for storing the stress in y direction</span>
<span class="n">JJJ</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># Array for storing the Jacobian</span>

<span class="k">def</span> <span class="nf">border</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">on_boundary</span><span class="p">):</span>
         <span class="k">return</span> <span class="n">on_boundary</span>

<span class="n">bound_x</span> <span class="o">=</span>  <span class="n">Expression</span><span class="p">((</span><span class="s2">&quot;t*x[0]&quot;</span><span class="p">),</span> <span class="n">degree</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">bound_y</span> <span class="o">=</span>  <span class="n">Expression</span><span class="p">((</span><span class="s2">&quot;t*x[1]&quot;</span><span class="p">),</span> <span class="n">degree</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>


<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">BC</span><span class="p">)):</span>


         <span class="n">bound_x</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">BC</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
         <span class="n">bound_y</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">BC</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

         <span class="n">bc_x</span> <span class="o">=</span> <span class="n">DirichletBC</span><span class="p">(</span><span class="n">V</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">bound_x</span><span class="p">,</span> <span class="n">border</span><span class="p">)</span>
         <span class="n">bc_y</span> <span class="o">=</span> <span class="n">DirichletBC</span><span class="p">(</span><span class="n">V</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">bound_y</span><span class="p">,</span> <span class="n">border</span><span class="p">)</span>
         <span class="n">bc_front</span> <span class="o">=</span> <span class="n">DirichletBC</span><span class="p">(</span><span class="n">V</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">Constant</span><span class="p">((</span><span class="mi">0</span><span class="p">)),</span> <span class="n">FRONT</span><span class="p">)</span>


         <span class="n">bc_all</span> <span class="o">=</span> <span class="p">[</span><span class="n">bc_x</span><span class="p">,</span><span class="n">bc_y</span><span class="p">,</span><span class="n">bc_front</span><span class="p">]</span>

         <span class="n">problem</span> <span class="o">=</span> <span class="n">NonlinearVariationalProblem</span><span class="p">(</span><span class="n">F1</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">bc_all</span><span class="p">,</span> <span class="n">Jac</span><span class="p">)</span>

         <span class="n">solver</span> <span class="o">=</span> <span class="n">NonlinearVariationalSolver</span><span class="p">(</span><span class="n">problem</span><span class="p">)</span>

         <span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>

         <span class="c1">#sig = inv(J)*(lmbda*ln(J)*I + mu * (b - I))</span>

         <span class="n">sig</span> <span class="o">=</span> <span class="p">(</span><span class="n">K</span> <span class="o">*</span> <span class="n">ln</span><span class="p">(</span><span class="n">J</span><span class="p">)</span> <span class="o">/</span> <span class="n">J</span><span class="p">)</span> <span class="o">*</span> <span class="n">I</span> <span class="o">+</span> <span class="mf">2.</span><span class="o">/</span><span class="n">J</span> <span class="o">*</span> <span class="p">(</span><span class="n">mu</span><span class="o">/</span><span class="mf">2.</span> <span class="o">*</span> <span class="n">B_bar</span> <span class="o">-</span> <span class="mf">1.</span><span class="o">/</span><span class="mf">3.</span> <span class="o">*</span> <span class="p">(</span><span class="n">mu</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">)</span> <span class="o">*</span> <span class="n">Ic_bar</span> <span class="o">*</span> <span class="n">I</span><span class="p">)</span>

         <span class="n">S</span> <span class="o">=</span> <span class="n">TensorFunctionSpace</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

         <span class="n">W</span> <span class="o">=</span> <span class="n">FunctionSpace</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

         <span class="n">sig1</span> <span class="o">=</span> <span class="n">project</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="n">S</span><span class="p">)</span>

         <span class="n">JJ</span> <span class="o">=</span> <span class="n">project</span><span class="p">(</span><span class="n">J</span><span class="p">,</span> <span class="n">W</span><span class="p">)</span>

         <span class="n">JJJ</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">JJ</span><span class="o">.</span><span class="n">vector</span><span class="p">()</span><span class="o">.</span><span class="n">get_local</span><span class="p">()[</span><span class="mi">0</span><span class="p">]))</span>

         <span class="n">sigma_11</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">sig1</span><span class="o">.</span><span class="n">vector</span><span class="p">()</span><span class="o">.</span><span class="n">get_local</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="mf">0.000001</span><span class="p">)</span>
         <span class="n">sigma_22</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">sig1</span><span class="o">.</span><span class="n">vector</span><span class="p">()</span><span class="o">.</span><span class="n">get_local</span><span class="p">()[</span><span class="mi">4</span><span class="p">])</span><span class="o">*</span><span class="mf">0.000001</span><span class="p">)</span>

         <span class="n">File</span><span class="p">(</span><span class="s2">&quot;displacement.pvd&quot;</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">u</span>

<span class="nb">print</span> <span class="p">(</span><span class="n">sigma_11</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">sigma_22</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">JJJ</span><span class="p">)</span>
</pre></div>
</div>
<p>Next figure shows how stress – stretch behavior of the model alters as the ratio <span class="math notranslate nohighlight">\(\frac{K}{\mu}\)</span> increases.</p>
<figure class="align-center" id="id11">
<img alt="../_images/3.png" src="../_images/3.png" />
<figcaption>
<p><span class="caption-number">Fig. 3 </span><span class="caption-text">Effect of compressibility in biaxial tension test– FEM (FEniCS) vs Analytical Solution</span><a class="headerlink" href="#id11" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>The above figure illustrates that when <span class="math notranslate nohighlight">\(\frac{K}{\mu}&gt;100\)</span> the behavior of the model starts converging to the fully incompressible Neo-Hookean model. When <span class="math notranslate nohighlight">\(\frac{K}{\mu}&gt;1000\)</span> the solution is matched with the fully incompressible material model as shown in next figure:</p>
<figure class="align-center" id="id12">
<img alt="../_images/4.png" src="../_images/4.png" />
<figcaption>
<p><span class="caption-number">Fig. 4 </span><span class="caption-text">Nearly incompressible material in biaxial tension test– FEM (FEniCS) vs Analytical</span><a class="headerlink" href="#id12" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>The other test that could be implemented is tracking the Jacobian when the stretch increases which is shown in the next figure:</p>
<figure class="align-center" id="id13">
<img alt="../_images/5.png" src="../_images/5.png" />
<figcaption>
<p><span class="caption-number">Fig. 5 </span><span class="caption-text">Effect of compressibility in the Jacobian of deformation gradient tensor in biaxial tension test</span><a class="headerlink" href="#id13" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>It could be seen that by approaching the <span class="math notranslate nohighlight">\(\frac{K}{\mu}\)</span> ratio to 1000, the Jacobian is set to unity regardless of the value of stretch indicating the material is nearly incompressible.</p>
</section>
</section>
<section id="compressible-model">
<h2>1.4. Compressible Model<a class="headerlink" href="#compressible-model" title="Permalink to this heading"></a></h2>
<section id="id3">
<h3>1.4.1. Constitutive Equations<a class="headerlink" href="#id3" title="Permalink to this heading"></a></h3>
<p>The strain energy function for a compressible Neo-Hookean material is defined as:</p>
<div class="math notranslate nohighlight" id="eq-42">
<span id="equation-eq-42"></span><span class="eqno">(42)<a class="headerlink" href="#eq-42" title="Permalink to this equation"></a></span>\[      W=\frac{\lambda}{2}{(lnJ)}^2 + \mu(lnJ) + \frac{1}{2} \mu (I_b-3)\]</div>
<p>In the above equation, the <span class="math notranslate nohighlight">\(\lambda\)</span> is the Lame constant which is equal to <span class="math notranslate nohighlight">\(\frac{E \nu}{(1+\nu)(1-2 \nu)}\)</span> where <span class="math notranslate nohighlight">\(E\)</span> is Young modulus and <span class="math notranslate nohighlight">\(\nu\)</span> is the Poisson ratio. In addition, the stress terms is represented as:</p>
<div class="math notranslate nohighlight" id="eq-43">
<span id="equation-eq-43"></span><span class="eqno">(43)<a class="headerlink" href="#eq-43" title="Permalink to this equation"></a></span>\[      \sigma=J^{-1}[\lambda(lnJ) \textbf{I}+ \mu(\textbf{b}-I)]\]</div>
</section>
<section id="id4">
<h3>1.4.2. Finite Element Implementation<a class="headerlink" href="#id4" title="Permalink to this heading"></a></h3>
<p>A finite element implementation in FEniCS for a biaxial tension test on a unit cube  is presented as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dolfin</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">stretch</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mf">1.2</span><span class="p">,</span><span class="mf">1.4</span><span class="p">,</span><span class="mf">1.6</span><span class="p">,</span><span class="mf">1.8</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mf">2.2</span><span class="p">,</span><span class="mf">2.4</span><span class="p">,</span><span class="mf">2.6</span><span class="p">,</span><span class="mf">2.8</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">3.2</span><span class="p">,</span><span class="mf">3.4</span><span class="p">,</span><span class="mf">3.6</span><span class="p">,</span><span class="mf">3.8</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mf">4.2</span><span class="p">,</span><span class="mf">4.4</span><span class="p">,</span><span class="mf">4.6</span><span class="p">,</span><span class="mf">4.8</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mf">5.2</span><span class="p">,</span><span class="mf">5.4</span><span class="p">,</span><span class="mf">5.6</span><span class="p">,</span><span class="mf">5.8</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span>

<span class="n">BC</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">stretch</span><span class="p">)):</span>
              <span class="n">M</span> <span class="o">=</span> <span class="n">stretch</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">-</span> <span class="mf">1.0</span>
              <span class="n">BC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>

<span class="n">strain</span> <span class="o">=</span> <span class="p">[]</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">BC</span><span class="p">)</span>
<span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">stretch</span><span class="p">)):</span>
              <span class="n">N</span> <span class="o">=</span> <span class="p">(</span><span class="n">BC</span><span class="p">[</span><span class="n">z</span><span class="p">])</span><span class="o">*</span><span class="mi">100</span>
              <span class="n">strain</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>


<span class="n">n</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># divisions in r direction</span>
<span class="n">mesh</span> <span class="o">=</span> <span class="n">BoxMesh</span><span class="p">(</span><span class="n">Point</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">Point</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

<span class="n">tol</span> <span class="o">=</span> <span class="mf">1E-14</span>
<span class="c1"># Define boundaries</span>
<span class="k">def</span> <span class="nf">LEFT</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">on_boundary</span><span class="p">):</span>
              <span class="k">return</span> <span class="n">on_boundary</span> <span class="ow">and</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">tol</span>

<span class="k">def</span> <span class="nf">RIGHT</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">on_boundary</span><span class="p">):</span>
              <span class="k">return</span> <span class="n">on_boundary</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tol</span>

<span class="k">def</span> <span class="nf">BOTTOM</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">on_boundary</span><span class="p">):</span>
              <span class="k">return</span> <span class="n">on_boundary</span> <span class="ow">and</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">tol</span>

<span class="k">def</span> <span class="nf">TOP</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">on_boundary</span><span class="p">):</span>
              <span class="k">return</span> <span class="n">on_boundary</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tol</span>

<span class="k">def</span> <span class="nf">FRONT</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">on_boundary</span><span class="p">):</span>
              <span class="k">return</span> <span class="n">on_boundary</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tol</span>

<span class="k">def</span> <span class="nf">BACK</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">on_boundary</span><span class="p">):</span>
              <span class="k">return</span> <span class="n">on_boundary</span> <span class="ow">and</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">tol</span>

<span class="n">boundaries</span> <span class="o">=</span> <span class="n">MeshFunction</span><span class="p">(</span><span class="s1">&#39;size_t&#39;</span><span class="p">,</span> <span class="n">mesh</span><span class="p">,</span> <span class="n">mesh</span><span class="o">.</span><span class="n">topology</span><span class="p">()</span><span class="o">.</span><span class="n">dim</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">domains</span> <span class="o">=</span> <span class="n">MeshFunction</span><span class="p">(</span><span class="s1">&#39;size_t&#39;</span><span class="p">,</span> <span class="n">mesh</span><span class="p">,</span> <span class="n">mesh</span><span class="o">.</span><span class="n">topology</span><span class="p">()</span><span class="o">.</span><span class="n">dim</span><span class="p">())</span>

<span class="n">ds</span> <span class="o">=</span> <span class="n">Measure</span><span class="p">(</span><span class="s2">&quot;ds&quot;</span><span class="p">,</span> <span class="n">subdomain_data</span><span class="o">=</span><span class="n">boundaries</span><span class="p">)</span>
<span class="n">dx</span> <span class="o">=</span> <span class="n">Measure</span><span class="p">(</span><span class="s1">&#39;dx&#39;</span><span class="p">,</span><span class="n">subdomain_data</span><span class="o">=</span><span class="n">domains</span><span class="p">)</span>

<span class="n">n</span> <span class="o">=</span> <span class="n">FacetNormal</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>

<span class="n">V</span> <span class="o">=</span> <span class="n">VectorFunctionSpace</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s1">&#39;CG&#39;</span><span class="p">,</span> <span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Define functions</span>
<span class="n">du</span>  <span class="o">=</span> <span class="n">TrialFunction</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>           <span class="c1"># Trial function</span>
<span class="n">v</span>  <span class="o">=</span> <span class="n">TestFunction</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>             <span class="c1"># Test function</span>
<span class="n">u</span>  <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>                 <span class="c1"># Displacement field</span>

<span class="c1"># Kinematics</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">geometric_dimension</span><span class="p">()</span>
<span class="n">I</span> <span class="o">=</span> <span class="n">Identity</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>             <span class="c1"># Identity tensor</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">I</span> <span class="o">+</span> <span class="n">grad</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>             <span class="c1"># Deformation gradient</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">T</span><span class="o">*</span><span class="n">F</span>                   <span class="c1"># Right Cauchy-Green tensor</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">F</span> <span class="o">*</span> <span class="n">F</span><span class="o">.</span><span class="n">T</span>                 <span class="c1"># Left Cauchy-Green tensor</span>
<span class="n">Ic</span> <span class="o">=</span> <span class="n">tr</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
<span class="n">J</span>  <span class="o">=</span> <span class="n">det</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>


<span class="n">nu</span> <span class="o">=</span><span class="mf">0.4</span>
<span class="n">G</span> <span class="o">=</span> <span class="mf">3.5e6</span>
<span class="n">E</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">*</span><span class="n">G</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span> <span class="n">nu</span><span class="p">)</span>
<span class="n">mu</span>  <span class="o">=</span> <span class="n">Constant</span><span class="p">(</span><span class="n">E</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">nu</span><span class="p">)))</span>
<span class="n">lmbda</span><span class="o">=</span> <span class="n">Constant</span><span class="p">(</span><span class="n">E</span><span class="o">*</span><span class="n">nu</span><span class="o">/</span><span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">nu</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">nu</span><span class="p">)))</span>

<span class="c1"># Total potential energy</span>
<span class="n">psi</span> <span class="o">=</span> <span class="p">((</span><span class="n">lmbda</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">)</span><span class="o">*</span><span class="nb">pow</span><span class="p">(</span><span class="n">ln</span><span class="p">(</span><span class="n">J</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">mu</span><span class="o">*</span><span class="n">ln</span><span class="p">(</span><span class="n">J</span><span class="p">)</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="n">mu</span><span class="o">*</span><span class="p">(</span><span class="n">Ic</span><span class="o">-</span><span class="mi">3</span><span class="p">))</span><span class="o">*</span><span class="n">dx</span>
<span class="n">F1</span> <span class="o">=</span> <span class="n">derivative</span><span class="p">(</span><span class="n">psi</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>

<span class="c1"># Compute Jacobian of F</span>
<span class="n">Jac</span> <span class="o">=</span> <span class="n">derivative</span><span class="p">(</span><span class="n">F1</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">du</span><span class="p">)</span>

<span class="n">sigma_11</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">sigma_22</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">JJJ</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">def</span> <span class="nf">border</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">on_boundary</span><span class="p">):</span>
              <span class="k">return</span> <span class="n">on_boundary</span>

<span class="n">bound_x</span> <span class="o">=</span>  <span class="n">Expression</span><span class="p">((</span><span class="s2">&quot;t*x[0]&quot;</span><span class="p">),</span> <span class="n">degree</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">bound_y</span> <span class="o">=</span>  <span class="n">Expression</span><span class="p">((</span><span class="s2">&quot;t*x[1]&quot;</span><span class="p">),</span> <span class="n">degree</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">SIG</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">stretch</span><span class="p">)):</span>

              <span class="n">bound_x</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">BC</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>
              <span class="n">bound_y</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">BC</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>

              <span class="n">bc_x</span> <span class="o">=</span> <span class="n">DirichletBC</span><span class="p">(</span><span class="n">V</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">bound_x</span><span class="p">,</span> <span class="n">border</span><span class="p">)</span>
              <span class="n">bc_y</span> <span class="o">=</span> <span class="n">DirichletBC</span><span class="p">(</span><span class="n">V</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">bound_y</span><span class="p">,</span> <span class="n">border</span><span class="p">)</span>
              <span class="n">bc_front</span> <span class="o">=</span> <span class="n">DirichletBC</span><span class="p">(</span><span class="n">V</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">Constant</span><span class="p">((</span><span class="mi">0</span><span class="p">)),</span> <span class="n">FRONT</span><span class="p">)</span>
              <span class="n">bc_back</span> <span class="o">=</span> <span class="n">DirichletBC</span><span class="p">(</span><span class="n">V</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">Constant</span><span class="p">((</span><span class="mi">0</span><span class="p">)),</span> <span class="n">BACK</span><span class="p">)</span>

              <span class="n">bc_all</span> <span class="o">=</span> <span class="p">[</span><span class="n">bc_x</span><span class="p">,</span><span class="n">bc_y</span><span class="p">,</span><span class="n">bc_front</span><span class="p">]</span>

              <span class="n">problem</span> <span class="o">=</span> <span class="n">NonlinearVariationalProblem</span><span class="p">(</span><span class="n">F1</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">bc_all</span><span class="p">,</span> <span class="n">Jac</span><span class="p">)</span>

              <span class="n">solver</span> <span class="o">=</span> <span class="n">NonlinearVariationalSolver</span><span class="p">(</span><span class="n">problem</span><span class="p">)</span>
              <span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>

              <span class="n">sigma</span> <span class="o">=</span> <span class="n">inv</span><span class="p">(</span><span class="n">J</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">lmbda</span> <span class="o">*</span> <span class="n">ln</span><span class="p">(</span><span class="n">J</span><span class="p">)</span> <span class="o">*</span> <span class="n">I</span> <span class="o">+</span> <span class="n">mu</span> <span class="o">*</span> <span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="n">I</span><span class="p">))</span>
              <span class="n">cauchy</span> <span class="o">=</span> <span class="n">project</span><span class="p">(</span><span class="n">sigma</span><span class="p">,</span> <span class="n">TensorFunctionSpace</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s1">&#39;DG&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

              <span class="n">SIG</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cauchy</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>

<span class="nb">print</span> <span class="p">(</span><span class="n">SIG</span><span class="p">)</span>
</pre></div>
</div>
<p>The obtained result for three different shear modulus (i.e. <span class="math notranslate nohighlight">\(\mu\)</span>) are compared in figure 10:</p>
<figure class="align-center" id="id14">
<img alt="../_images/6.png" src="../_images/6.png" />
<figcaption>
<p><span class="caption-number">Fig. 6 </span><span class="caption-text">Stress results of Neo-Hokean compressible model for a single element under biaxial stretch</span><a class="headerlink" href="#id14" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There is another form of strain energy function for a compressible neo-Hookean material:</p>
<div class="math notranslate nohighlight" id="eq-44">
<span id="equation-eq-44"></span><span class="eqno">(44)<a class="headerlink" href="#eq-44" title="Permalink to this equation"></a></span>\[           W=\frac{1}{2}K(lnJ)^2 + \frac{1}{2} \mu (J^{\frac{-2}{3}} I_b-3)\]</div>
<p>The stress tensor is defined as following:</p>
<div class="math notranslate nohighlight" id="eq-45">
<span id="equation-eq-45"></span><span class="eqno">(45)<a class="headerlink" href="#eq-45" title="Permalink to this equation"></a></span>\[           \sigma=J^{-1}[K \ ln(J)+ \mu J^{\frac{-2}{3}}(\textbf{b}-\frac{1}{3}tr(b) \textbf{I})]\]</div>
<p>In the above equation, <span class="math notranslate nohighlight">\(K\)</span> is the bulk modulus. As a practice you can implement th above equations in the code and compare your results with the previous forms of strain energy function and stress!</p>
</div>
</section>
</section>
<section id="axisymmetric-model">
<h2>1.5. Axisymmetric Model<a class="headerlink" href="#axisymmetric-model" title="Permalink to this heading"></a></h2>
<p>We consider a sphere which is under an external pressure that could be taken as an axisymmetric problem. This geometry could be seen as revolution of a cross section with respect to the axis of symmetry.</p>
<section id="constitutive-equation">
<h3>1.5.1. Constitutive Equation<a class="headerlink" href="#constitutive-equation" title="Permalink to this heading"></a></h3>
<p>For an axisymmetric problem, the displacement field is defined as following:</p>
<div class="math notranslate nohighlight" id="eq-46">
<span id="equation-eq-46"></span><span class="eqno">(46)<a class="headerlink" href="#eq-46" title="Permalink to this equation"></a></span>\[ u = u_r e_r + u_z e_z\]</div>
<p>The strain energy function is defined as presented in <a class="reference internal" href="#eq-39"><span class="std std-ref">Equation.39</span></a>.
In case of axisymmetric the gradient of displacement field is defined as below:</p>
<div class="math notranslate nohighlight" id="eq-47">
<span id="equation-eq-47"></span><span class="eqno">(47)<a class="headerlink" href="#eq-47" title="Permalink to this equation"></a></span>\[\begin{split} \nabla u = \begin{bmatrix} \frac {\partial u_r}{\partial r} &amp; 0 &amp; \frac {\partial u_r}{\partial z}\\0 &amp; \frac {u_r}{r} &amp; 0\\ \frac {\partial u_z}{\partial r} &amp; 0 &amp; \frac {\partial u_z}{\partial z}\end{bmatrix}\end{split}\]</div>
<p>In general, in case of nonlinear problems, the abstract formulation for nonlinear form is defined as:</p>
<div class="math notranslate nohighlight" id="eq-48">
<span id="equation-eq-48"></span><span class="eqno">(48)<a class="headerlink" href="#eq-48" title="Permalink to this equation"></a></span>\[ F(u,v)=0 \ \forall v \in V\]</div>
<p>In order to find the F in the above equation, first we need to define total potential energy with regard to axisymmetric formulation:</p>
<div class="math notranslate nohighlight" id="eq-49">
<span id="equation-eq-49"></span><span class="eqno">(49)<a class="headerlink" href="#eq-49" title="Permalink to this equation"></a></span>\[ \phi= \int_{V} W(u) \,dV - \int_{\partial V} P \,dA\]</div>
<p>Where <span class="math notranslate nohighlight">\(W\)</span> is the strain energy function and <span class="math notranslate nohighlight">\(P\)</span> corresponds to the loads applied on the boundaries.
In the above equation <span class="math notranslate nohighlight">\(dV\)</span> and <span class="math notranslate nohighlight">\(dA\)</span> are the integration symbols over the domains <span class="math notranslate nohighlight">\(V\)</span> and boundaries <span class="math notranslate nohighlight">\(\partial V\)</span>. In axisymmetric formulation, we should replace the integration measure <span class="math notranslate nohighlight">\(dV\)</span> and <span class="math notranslate nohighlight">\(dA\)</span> by <span class="math notranslate nohighlight">\(rd \theta dA\)</span> and <span class="math notranslate nohighlight">\(rd \theta ds\)</span> respectively. After substitution in the above equation, the term <span class="math notranslate nohighlight">\(d\theta\)</span> is canceled out from both sides and the above equation yields to:</p>
<div class="math notranslate nohighlight" id="eq-50">
<span id="equation-eq-50"></span><span class="eqno">(50)<a class="headerlink" href="#eq-50" title="Permalink to this equation"></a></span>\[ \phi= \int_{A} W(u) \,rdA - \int_{\partial A} P \,rds\]</div>
<p>In the next step by taking directional derivative from the <span class="math notranslate nohighlight">\(\phi\)</span> with respect to the test function <span class="math notranslate nohighlight">\(v\)</span> , we can find the <span class="math notranslate nohighlight">\(F(u,v)\)</span> as following:</p>
<div class="math notranslate nohighlight" id="eq-51">
<span id="equation-eq-51"></span><span class="eqno">(51)<a class="headerlink" href="#eq-51" title="Permalink to this equation"></a></span>\[ F(u,v)= \lim_{\epsilon\to\infty} \frac {d}{d \epsilon} \phi(u+ \epsilon v)\]</div>
</section>
<section id="id5">
<h3>1.5.2. Finite Element Implementation<a class="headerlink" href="#id5" title="Permalink to this heading"></a></h3>
<p>In order to generate the mesh, we considered the cross section of the sphere as a 2D axisymmetric problem. GMSH was used for mesh generation and structured mesh was created with triangular elements. The red arrows correspond to the external pressure on the sphere. The left edge (e.g., axis of symmetry) is constrained to move in the x direction while the bottom edge is constrained to move in the y direction. The parameters used for this simulation are: <span class="math notranslate nohighlight">\(\mu = 1 MPa\)</span> , <span class="math notranslate nohighlight">\(K = 1 GPa\)</span> and <span class="math notranslate nohighlight">\(P = 10 Pa\)</span> .The dimensions of the geometry, mesh, pressure load and boundary conditions are shown in next figure:</p>
<figure class="align-center" id="id15">
<img alt="../_images/7.png" src="../_images/7.png" />
<figcaption>
<p><span class="caption-number">Fig. 7 </span><span class="caption-text">Geometry of the cross section making the hemisphere (Left), the mesh generated in GMSH (Middle), load and boundary conditions (Right)</span><a class="headerlink" href="#id15" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>The above equations were implemented in FEniCS. The code is presented  here:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dolfin</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;form_compiler&quot;</span><span class="p">][</span><span class="s2">&quot;representation&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;tsfc&quot;</span>

<span class="n">mesh</span> <span class="o">=</span> <span class="n">Mesh</span><span class="p">(</span><span class="s2">&quot;MESH.xml&quot;</span><span class="p">)</span>


<span class="n">facets</span> <span class="o">=</span> <span class="n">MeshFunction</span><span class="p">(</span><span class="s2">&quot;size_t&quot;</span><span class="p">,</span> <span class="n">mesh</span><span class="p">,</span> <span class="s2">&quot;MESH_facet_region.xml&quot;</span><span class="p">)</span>
<span class="n">domains</span> <span class="o">=</span> <span class="n">MeshFunction</span><span class="p">(</span><span class="s2">&quot;size_t&quot;</span><span class="p">,</span> <span class="n">mesh</span><span class="p">,</span> <span class="s2">&quot;MESH_physical_region.xml&quot;</span><span class="p">)</span>

<span class="n">ds</span> <span class="o">=</span> <span class="n">Measure</span><span class="p">(</span><span class="s2">&quot;ds&quot;</span><span class="p">,</span> <span class="n">subdomain_data</span><span class="o">=</span><span class="n">facets</span><span class="p">)</span>
<span class="n">dx</span> <span class="o">=</span> <span class="n">Measure</span><span class="p">(</span><span class="s1">&#39;dx&#39;</span><span class="p">,</span><span class="n">subdomain_data</span><span class="o">=</span><span class="n">domains</span><span class="p">)</span>

<span class="c1">#File(&quot;bound.pvd&quot;) &lt;&lt; facets</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">SpatialCoordinate</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">GRAD</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>

         <span class="k">return</span> <span class="n">as_tensor</span><span class="p">([[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">dx</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">dx</span><span class="p">(</span><span class="mi">1</span><span class="p">)],</span>
                             <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">],</span>
                             <span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">dx</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">dx</span><span class="p">(</span><span class="mi">1</span><span class="p">)]])</span>


<span class="n">n</span> <span class="o">=</span> <span class="n">FacetNormal</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">Constant</span><span class="p">(</span><span class="mf">100.</span><span class="p">)</span>


<span class="n">V</span> <span class="o">=</span> <span class="n">VectorFunctionSpace</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s1">&#39;CG&#39;</span><span class="p">,</span> <span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># Define functions</span>
<span class="n">du</span>  <span class="o">=</span> <span class="n">TrialFunction</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>           <span class="c1"># Trial function</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">TestFunction</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>             <span class="c1"># Test function</span>
<span class="n">u</span>  <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>                 <span class="c1"># Displacement field</span>


<span class="n">d</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">geometric_dimension</span><span class="p">()</span>
<span class="n">I</span> <span class="o">=</span> <span class="n">Identity</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">I</span> <span class="o">+</span> <span class="n">GRAD</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>             <span class="c1"># Deformation gradient</span>

<span class="c1">#F = FF(u)</span>

<span class="n">C</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">T</span><span class="o">*</span><span class="n">F</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">F</span><span class="o">*</span><span class="n">F</span><span class="o">.</span><span class="n">T</span>
<span class="n">Ic</span> <span class="o">=</span> <span class="n">tr</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
<span class="n">J</span>  <span class="o">=</span> <span class="n">det</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="n">Ib</span> <span class="o">=</span> <span class="n">tr</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>

<span class="n">Ic_bar</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">J</span><span class="p">,</span><span class="o">-</span><span class="mf">2.</span><span class="o">/</span><span class="mf">3.</span><span class="p">)</span><span class="o">*</span><span class="n">Ic</span>
<span class="n">C_bar</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">J</span><span class="p">,</span><span class="o">-</span><span class="mf">2.</span><span class="o">/</span><span class="mf">3.</span><span class="p">)</span><span class="o">*</span><span class="n">C</span>
<span class="n">B_bar</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">J</span><span class="p">,</span><span class="o">-</span><span class="mf">2.</span><span class="o">/</span><span class="mf">3.</span><span class="p">)</span><span class="o">*</span><span class="n">b</span>

<span class="n">mu</span> <span class="o">=</span> <span class="mf">1E6</span>
<span class="n">K</span> <span class="o">=</span> <span class="mf">1E9</span>


<span class="n">psi</span> <span class="o">=</span> <span class="p">(</span><span class="n">mu</span><span class="o">/</span><span class="mf">2.</span> <span class="o">*</span> <span class="p">(</span><span class="n">Ic_bar</span> <span class="o">-</span> <span class="mf">3.</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">K</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">ln</span><span class="p">(</span><span class="n">J</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">dx</span> <span class="o">-</span> <span class="n">inner</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="o">*</span><span class="n">n</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">ds</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>

<span class="n">bcs</span> <span class="o">=</span> <span class="p">[</span><span class="n">DirichletBC</span><span class="p">(</span><span class="n">V</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Constant</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">facets</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
            <span class="n">DirichletBC</span><span class="p">(</span><span class="n">V</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">Constant</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">facets</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>

<span class="n">F1</span> <span class="o">=</span> <span class="n">derivative</span><span class="p">(</span><span class="n">psi</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>

<span class="c1"># Compute Jacobian of F</span>
<span class="n">Jac</span> <span class="o">=</span> <span class="n">derivative</span><span class="p">(</span><span class="n">F1</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">du</span><span class="p">)</span>

<span class="n">problem</span> <span class="o">=</span> <span class="n">NonlinearVariationalProblem</span><span class="p">(</span><span class="n">F1</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">bcs</span><span class="p">,</span> <span class="n">Jac</span><span class="p">)</span>

<span class="n">solver</span> <span class="o">=</span> <span class="n">NonlinearVariationalSolver</span><span class="p">(</span><span class="n">problem</span><span class="p">)</span>


<span class="n">solver</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;newton_solver&quot;</span><span class="p">][</span><span class="s2">&quot;relative_tolerance&quot;</span><span class="p">]</span><span class="o">=</span><span class="mf">5e-9</span>

<span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
<span class="n">File</span><span class="p">(</span><span class="s2">&quot;Displacement.pvd&quot;</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">u</span>

<span class="n">SIGMA_XX</span> <span class="o">=</span> <span class="p">(</span><span class="n">K</span> <span class="o">*</span> <span class="n">ln</span><span class="p">(</span><span class="n">J</span><span class="p">)</span> <span class="o">/</span> <span class="n">J</span><span class="p">)</span> <span class="o">*</span> <span class="n">I</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="mf">2.</span> <span class="o">/</span> <span class="n">J</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">mu</span><span class="o">/</span><span class="mf">2.</span> <span class="o">*</span> <span class="p">(</span><span class="n">B_bar</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">/</span> <span class="mf">3.</span><span class="p">)</span> <span class="o">*</span> <span class="n">Ic_bar</span> <span class="o">*</span> <span class="n">I</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span>

<span class="n">SIGMA_YY</span> <span class="o">=</span> <span class="p">(</span><span class="n">K</span> <span class="o">*</span> <span class="n">ln</span><span class="p">(</span><span class="n">J</span><span class="p">)</span> <span class="o">/</span> <span class="n">J</span><span class="p">)</span> <span class="o">*</span> <span class="n">I</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="mf">2.</span> <span class="o">/</span> <span class="n">J</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">mu</span><span class="o">/</span><span class="mf">2.</span> <span class="o">*</span> <span class="p">(</span><span class="n">B_bar</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">/</span> <span class="mf">3.</span><span class="p">)</span> <span class="o">*</span> <span class="n">Ic_bar</span> <span class="o">*</span> <span class="n">I</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span>

<span class="n">W</span> <span class="o">=</span> <span class="n">FunctionSpace</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">STRESS_XX</span> <span class="o">=</span> <span class="n">project</span><span class="p">(</span><span class="n">SIGMA_XX</span><span class="p">,</span> <span class="n">W</span><span class="p">)</span>
<span class="n">STRESS_YY</span> <span class="o">=</span> <span class="n">project</span><span class="p">(</span><span class="n">SIGMA_YY</span><span class="p">,</span> <span class="n">W</span><span class="p">)</span>

<span class="n">File</span><span class="p">(</span><span class="s2">&quot;SIG_X.pvd&quot;</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">STRESS_XX</span>
<span class="n">File</span><span class="p">(</span><span class="s2">&quot;SIG_Y.pvd&quot;</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">STRESS_YY</span>
</pre></div>
</div>
<p>The same model with the same geometry, loading, boundary conditions and mesh was generated in ANSYS APDL.</p>
<p>The PLANE 182 element was used for the simulation in ANSYS with axisymmetric element behavior. The displacement results in the x and y directions obtained from ANSYS and FEniCS implementation are shown in the figures:</p>
<figure class="align-center" id="id16">
<img alt="../_images/8.png" src="../_images/8.png" />
<figcaption>
<p><span class="caption-number">Fig. 8 </span><span class="caption-text">The displacement results in X direction (FEniCS) vs ANSYS</span><a class="headerlink" href="#id16" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<figure class="align-center" id="id17">
<img alt="../_images/9.png" src="../_images/9.png" />
<figcaption>
<p><span class="caption-number">Fig. 9 </span><span class="caption-text">The displacement results in Y direction (FEniCS) vs ANSYS</span><a class="headerlink" href="#id17" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</section>
</section>
<section id="von-mises-fiber-model">
<h2>1.6 von-Mises Fiber Model<a class="headerlink" href="#von-mises-fiber-model" title="Permalink to this heading"></a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Please read <a class="reference external" href="https://asmedigitalcollection.asme.org/biomechanical/article-abstract/131/5/051011/397644/Peripapillary-and-Posterior-Scleral-Mechanics-Part">this paper</a> and <a class="reference external" href="https://link.springer.com/article/10.1007/s10237-022-01590-5">this paper</a> for more details about this model.</p>
</div>
<section id="id7">
<h3>1.6.1. Introduction<a class="headerlink" href="#id7" title="Permalink to this heading"></a></h3>
<p>The strain energy function is defined as following:</p>
<div class="math notranslate nohighlight" id="eq-52">
<span id="equation-eq-52"></span><span class="eqno">(52)<a class="headerlink" href="#eq-52" title="Permalink to this equation"></a></span>\[ W = W_{matrix}+W_{fiber}\]</div>
<p>The ground substance  <span class="math notranslate nohighlight">\(W_{matrix}\)</span> is defined as Neo-Hookean material with this energy function:</p>
<div class="math notranslate nohighlight" id="eq-53">
<span id="equation-eq-53"></span><span class="eqno">(53)<a class="headerlink" href="#eq-53" title="Permalink to this equation"></a></span>\[ W_{matrix} = c_{1}(I_1-3)\]</div>
<p>The part of strain energy function which is related to the fibers is presented as:</p>
<div class="math notranslate nohighlight" id="eq-54">
<span id="equation-eq-54"></span><span class="eqno">(54)<a class="headerlink" href="#eq-54" title="Permalink to this equation"></a></span>\[ W_{matrix} = \int_{\theta_p- \frac{\pi}{2}}^{\theta_p + \frac{\pi}{2}} P(\theta) W_{fiber} \circ I_4 (\theta) d \theta\]</div>
<p>In the above equation, the fourth invariant of <span class="math notranslate nohighlight">\(C\)</span> tensor <span class="math notranslate nohighlight">\(I_4 (\theta)\)</span> is:</p>
<div class="math notranslate nohighlight" id="eq-55">
<span id="equation-eq-55"></span><span class="eqno">(55)<a class="headerlink" href="#eq-55" title="Permalink to this equation"></a></span>\[ I_4 (\theta) = a_0 (\theta) . C . a_0 (\theta)  = \lambda^2 (\theta)\]</div>
<p>Where <span class="math notranslate nohighlight">\(a_0 (\theta)\)</span> defines the orientation of the fibers. In addition, <span class="math notranslate nohighlight">\(P(\theta)\)</span> is the distribution function
defined as:</p>
<div class="math notranslate nohighlight" id="eq-56">
<span id="equation-eq-56"></span><span class="eqno">(56)<a class="headerlink" href="#eq-56" title="Permalink to this equation"></a></span>\[ P(\theta) = \frac{1}{\pi I_0 (k)} e^{k \cos (x)} dx\]</div>
<p><span class="math notranslate nohighlight">\(k\)</span> is the fiber concentration factor and <span class="math notranslate nohighlight">\(\theta_p)\)</span> is the preferred fiber orientation. The strain energy function associated with collagen fibers family is defined as following:</p>
<div class="math notranslate nohighlight" id="eq-57">
<span id="equation-eq-57"></span><span class="eqno">(57)<a class="headerlink" href="#eq-57" title="Permalink to this equation"></a></span>\[ \lambda (\theta) \frac{\partial W_{fiber} \circ I_4 (\theta)}{\partial \lambda(\theta)} = c_3 (e^{c_4 (\lambda (\theta) - 1} -1)\]</div>
<p>Where <span class="math notranslate nohighlight">\(c_3\)</span> is the exponential fiber stress coefficient and <span class="math notranslate nohighlight">\(c_4\)</span> is the rate of uncrimping collagen fibers.</p>
</section>
<section id="stress-tensor">
<h3>1.6.2. Stress Tensor<a class="headerlink" href="#stress-tensor" title="Permalink to this heading"></a></h3>
<p>The second Piola-Kirchhoff stress tensor could be represented as:</p>
<div class="math notranslate nohighlight" id="eq-58">
<span id="equation-eq-58"></span><span class="eqno">(58)<a class="headerlink" href="#eq-58" title="Permalink to this equation"></a></span>\[ \mathbf{S} = pJ \mathbf{C^{-1}} + 2J^{\frac{-2}{3}} DEV[\frac{\partial W}{\partial C}]\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The operator <span class="math notranslate nohighlight">\(DEV[.]\)</span> is the deviatoric projection operator.</p>
</div>
<p>We start with the matrix part and by using chain rule:</p>
<div class="math notranslate nohighlight" id="eq-59">
<span id="equation-eq-59"></span><span class="eqno">(59)<a class="headerlink" href="#eq-59" title="Permalink to this equation"></a></span>\[ \frac{\partial W}{\partial C} = \frac{\partial W}{\partial I_1} \times \frac{\partial I_1}{\partial C}\]</div>
<p>The second term on the right hand side of the above equation is equal to identity tensor (See <a class="reference internal" href="#eq-6"><span class="std std-ref">Equation.6</span></a></p>
<p>On the other hand:</p>
<div class="math notranslate nohighlight" id="eq-60">
<span id="equation-eq-60"></span><span class="eqno">(60)<a class="headerlink" href="#eq-60" title="Permalink to this equation"></a></span>\[ \frac{\partial W_{fiber}}{\partial C} = c_1 \mathbf{I}\]</div>
<div class="math notranslate nohighlight" id="eq-61">
<span id="equation-eq-61"></span><span class="eqno">(61)<a class="headerlink" href="#eq-61" title="Permalink to this equation"></a></span>\[ S = pJC^{-1}+2J^{\frac{-2}{3}} [c_1 I - \frac{1}{3}(c_1 I : C)C^{-1}]\]</div>
<p>We know that <span class="math notranslate nohighlight">\(I:C=I_1\)</span>:</p>
<div class="math notranslate nohighlight" id="eq-62">
<span id="equation-eq-62"></span><span class="eqno">(62)<a class="headerlink" href="#eq-62" title="Permalink to this equation"></a></span>\[ S = pJC^{-1}+2J^{\frac{-2}{3}} [c_1 (I - \frac{1}{3} I_1 C^{-1})]\]</div>
<p>We derive the stress term for the fiber part. The strain energy
function for the fibers is derived from <span class="math notranslate nohighlight">\(W_{fiber} \circ I_4(\theta)\)</span> :</p>
<div class="math notranslate nohighlight" id="eq-63">
<span id="equation-eq-63"></span><span class="eqno">(63)<a class="headerlink" href="#eq-63" title="Permalink to this equation"></a></span>\[ S = 2J^{\frac{-2}{3}} DEV [\frac{\partial W_{fiber} \circ I_4 (\theta)}{\partial C}]\]</div>
<p>The term in the bracket could be rewritten using the chain rule:</p>
<div class="math notranslate nohighlight" id="eq-64">
<span id="equation-eq-64"></span><span class="eqno">(64)<a class="headerlink" href="#eq-64" title="Permalink to this equation"></a></span>\[ \frac{\partial W_{fiber} \circ I_4 (\theta)}{\partial C} = \frac{\partial W_{fiber} \circ I_4 (\theta)}{\partial I_4} \times \frac{I_4}{\partial C}\]</div>
<p>The first term in the right hand side of the above equation, could be presented again using the chain rule:</p>
<div class="math notranslate nohighlight" id="eq-65">
<span id="equation-eq-65"></span><span class="eqno">(65)<a class="headerlink" href="#eq-65" title="Permalink to this equation"></a></span>\[ \frac{\partial W_{fiber} \circ I_4 (\theta)}{\partial I_4} = \frac{\partial W_{fiber} \circ I_4 (\theta)}{\partial \lambda (\theta)} \times \frac{\partial \lambda (\theta)}{\partial I_4}\]</div>
<p>We know that <span class="math notranslate nohighlight">\(I_4 (\theta)= \lambda^2 (\theta)\)</span> . Thus, the second term in the right hand side of the above equation could be simplified to:</p>
<div class="math notranslate nohighlight" id="eq-66">
<span id="equation-eq-66"></span><span class="eqno">(66)<a class="headerlink" href="#eq-66" title="Permalink to this equation"></a></span>\[ \frac{\partial I_4}{\partial \lambda (\theta)} = 2\lambda (\theta) \Rightarrow \frac{\partial \lambda (\theta)}{\partial I_4} = \frac {1}{2 \lambda (\theta)}\]</div>
<p>We know that:</p>
<div class="math notranslate nohighlight" id="eq-67">
<span id="equation-eq-67"></span><span class="eqno">(67)<a class="headerlink" href="#eq-67" title="Permalink to this equation"></a></span>\[ \lambda (\theta) \frac{\partial W_{fiber} \circ I_4 (\theta)}{\partial \lambda (\theta)} = c_3 [e^{c_4(\lambda(\theta)-1)}-1]\]</div>
<p>Then by combining the equations:</p>
<div class="math notranslate nohighlight" id="eq-68">
<span id="equation-eq-68"></span><span class="eqno">(68)<a class="headerlink" href="#eq-68" title="Permalink to this equation"></a></span>\[ \frac{\partial W_{fiber} \circ I_4 (\theta)}{\partial I_4} = \frac{1}{2 \lambda^2 (\theta)} c_3 [e^{c_4 (\lambda (\theta)-1)}-1] = \eta\]</div>
<p>And then we can write:</p>
<div class="math notranslate nohighlight" id="eq-69">
<span id="equation-eq-69"></span><span class="eqno">(69)<a class="headerlink" href="#eq-69" title="Permalink to this equation"></a></span>\[ S = 2J^{\frac{-2}{3}}[a_0 (\theta).a_0 (\theta) \int_{\theta_p- \frac{\pi}{2}}^{\theta_p + \frac{\pi}{2}} P(\theta) \eta d \theta - [ \frac{1}{3} a_0 (\theta).a_0 (\theta):C \times \int_{\theta_p- \frac{\pi}{2}}^{\theta_p + \frac{\pi}{2}} P(\theta) \eta d \theta ]C^{-1}]\]</div>
<div class="math notranslate nohighlight" id="eq-70">
<span id="equation-eq-70"></span><span class="eqno">(70)<a class="headerlink" href="#eq-70" title="Permalink to this equation"></a></span>\[ S = 2J^{\frac{-2}{3}}[\int_{\theta_p- \frac{\pi}{2}}^{\theta_p + \frac{\pi}{2}} P(\theta) \eta d \theta[a_0 (\theta).a_0 (\theta) - \frac{1}{3} I_4 C^{-1}] d \theta ]\]</div>
<p>Now by combining with the stress obtained from the strain energy of the matrix part:</p>
<div class="math notranslate nohighlight" id="eq-71">
<span id="equation-eq-71"></span><span class="eqno">(71)<a class="headerlink" href="#eq-71" title="Permalink to this equation"></a></span>\[ \mathbf{S} = pJC^{-1} + 2J^{\frac{-2}{3}}[c_1 (I - \frac{1}{3} I_1 C^{-1}) +
  \int_{\theta_p- \frac{\pi}{2}}^{\theta_p + \frac{\pi}{2}} P(\theta) \eta [a_0 (\theta).a_0 (\theta)-\frac{1}{3} I_4 C^{-1}] d \theta ]\]</div>
<p>The Cauchy stress yields to:</p>
<div class="math notranslate nohighlight" id="eq-72">
<span id="equation-eq-72"></span><span class="eqno">(72)<a class="headerlink" href="#eq-72" title="Permalink to this equation"></a></span>\[ \mathbf{\sigma} = \frac{1}{J} F.S.F^T = P \mathbf{I}+ \frac{2}{J}[c_1(\mathbf{B}-\frac{1}{3}I_1 \mathbf{I}]+\int_{\theta_p- \frac{\pi}{2}}^{\theta_p + \frac{\pi}{2}} P(\theta,k)W_4 I_4 [a_0 (\theta) \otimes a_0 (\theta)-\frac{1}{3} \mathbf{I}] d \theta]\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <span class="math notranslate nohighlight">\(\mathbf{B}\)</span> is the left cauchy stress tensor and <span class="math notranslate nohighlight">\(W_4(\theta)= \frac{1}{2 \lambda^2 (\theta)}c_3 [e^{c_4(\lambda (\theta) - 1)}-1]\)</span></p>
</div>
</section>
<section id="strain-energy-function">
<h3>1.6.3. Strain Energy Function<a class="headerlink" href="#strain-energy-function" title="Permalink to this heading"></a></h3>
<p>In general the strain energy function in the von-Mises fiber model is represented as:</p>
<div class="math notranslate nohighlight" id="eq-73">
<span id="equation-eq-73"></span><span class="eqno">(73)<a class="headerlink" href="#eq-73" title="Permalink to this equation"></a></span>\[ \tilde{W}= F_m (\tilde{I_1}) + \int_{\theta_p-\frac{\pi}{2}}^ {\theta_p+\frac{\pi}{2}} P(\theta) F(\tilde{\lambda}) d \theta+\frac{K}{2}[Ln(J)]^2\]</div>
<p>Where <span class="math notranslate nohighlight">\(F_m (\tilde{I_1})\)</span> corresponds to the contribution from the matrix:</p>
<div class="math notranslate nohighlight" id="eq-74">
<span id="equation-eq-74"></span><span class="eqno">(74)<a class="headerlink" href="#eq-74" title="Permalink to this equation"></a></span>\[ F_m(\tilde{I_1})=c_1(\tilde{I_1}-3)\]</div>
<p>The contribution from the fiber part is:</p>
<div class="math notranslate nohighlight" id="eq-75">
<span id="equation-eq-75"></span><span class="eqno">(75)<a class="headerlink" href="#eq-75" title="Permalink to this equation"></a></span>\[ F_f(\tilde{\lambda})=c_3(e^{-c_4}[Ei(c_4 \tilde{\lambda})-Ei(c_4)]-Ln(\tilde{\lambda}))\]</div>
<p>The <span class="math notranslate nohighlight">\(\tilde{\lambda}\)</span> is the stretch represented as following:</p>
<div class="math notranslate nohighlight" id="eq-76">
<span id="equation-eq-76"></span><span class="eqno">(76)<a class="headerlink" href="#eq-76" title="Permalink to this equation"></a></span>\[ \tilde{\lambda}^2=\tilde{I}_4= \textbf{a}_0 (\theta).\tilde{\textbf{C}}.\textbf{a}_0(\theta)\]</div>
<p>The distribution function is expressed as:</p>
<div class="math notranslate nohighlight" id="eq-77">
<span id="equation-eq-77"></span><span class="eqno">(77)<a class="headerlink" href="#eq-77" title="Permalink to this equation"></a></span>\[ P(\theta)=\frac{1}{\pi I_0(k_f)}e^{k_f cos2(\theta-\theta_p)}\]</div>
<p>In the above, the <span class="math notranslate nohighlight">\(I_0(k_f)\)</span> is the the Bessel function of the first kind:</p>
<div class="math notranslate nohighlight" id="eq-78">
<span id="equation-eq-78"></span><span class="eqno">(78)<a class="headerlink" href="#eq-78" title="Permalink to this equation"></a></span>\[ I_0 (k_f)=\frac{1}{\pi} \int_{0}^{\pi} e^{k_fcos(x)}dx\]</div>
</section>
<section id="id8">
<h3>1.6.4. Finite Element Implementation<a class="headerlink" href="#id8" title="Permalink to this heading"></a></h3>
<p>We implement this model in a finite element code on a cube element where the fibers are aligned in Y direction (Vertical) and the element is under biaxial stretch. The values of the constants of <span class="math notranslate nohighlight">\(c_1\)</span> , <span class="math notranslate nohighlight">\(c_3\)</span> and <span class="math notranslate nohighlight">\(c_4\)</span> are equal to 10Pa, 50 Pa and 5 respectively. In addition the bulk modulus <span class="math notranslate nohighlight">\(K\)</span> is equal to 1 GPa.
We implement the numerical integration by trapezoidal rule. In addition, in order to define the plane where the fibers are confined with, we should use Discontinuous Galerkin function space and then assign the vector values <span class="math notranslate nohighlight">\(\vec{a}\)</span> and <span class="math notranslate nohighlight">\(\vec{b}\)</span> to each element by using the index of the elements. Here is the FEniCS implementation and validation against the analytical solution:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dolfin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">setrecursionlimit</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>


<span class="n">stretch</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.05</span><span class="p">,</span><span class="mf">1.1</span><span class="p">,</span><span class="mf">1.15</span><span class="p">,</span><span class="mf">1.2</span><span class="p">,</span><span class="mf">1.25</span><span class="p">,</span><span class="mf">1.3</span><span class="p">,</span><span class="mf">1.35</span><span class="p">,</span><span class="mf">1.4</span><span class="p">,</span><span class="mf">1.45</span><span class="p">,</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">1.55</span><span class="p">,</span><span class="mf">1.6</span><span class="p">]</span>

<span class="n">BC</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">stretch</span><span class="p">)):</span>
    <span class="n">N</span> <span class="o">=</span> <span class="n">stretch</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">-</span> <span class="mf">1.0</span>
    <span class="n">BC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

<span class="n">tol</span> <span class="o">=</span> <span class="mf">1E-14</span>

<span class="c1"># Define boundary</span>
<span class="k">def</span> <span class="nf">LEFT</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">on_boundary</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">on_boundary</span> <span class="ow">and</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">tol</span>

<span class="k">def</span> <span class="nf">RIGHT</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">on_boundary</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">on_boundary</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tol</span>

<span class="k">def</span> <span class="nf">BOTTOM</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">on_boundary</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">on_boundary</span> <span class="ow">and</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">tol</span>

<span class="k">def</span> <span class="nf">TOP</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">on_boundary</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">on_boundary</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tol</span>

<span class="k">def</span> <span class="nf">FRONT</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">on_boundary</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">on_boundary</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tol</span>

<span class="k">def</span> <span class="nf">BACK</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">on_boundary</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">on_boundary</span> <span class="ow">and</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">tol</span>


<span class="n">mesh</span> <span class="o">=</span> <span class="n">UnitCubeMesh</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">CellType</span><span class="o">.</span><span class="n">Type</span><span class="o">.</span><span class="n">tetrahedron</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">FacetNormal</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>

<span class="n">V</span> <span class="o">=</span> <span class="n">VectorFunctionSpace</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s1">&#39;CG&#39;</span><span class="p">,</span> <span class="n">degree</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">du</span>  <span class="o">=</span> <span class="n">TrialFunction</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>           <span class="c1"># Trial function</span>
<span class="n">v</span>  <span class="o">=</span> <span class="n">TestFunction</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>             <span class="c1"># Test function</span>
<span class="n">u</span>  <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
<span class="c1">#############################################</span>

<span class="n">boundaries</span> <span class="o">=</span> <span class="n">MeshFunction</span><span class="p">(</span><span class="s1">&#39;size_t&#39;</span><span class="p">,</span> <span class="n">mesh</span><span class="p">,</span> <span class="n">mesh</span><span class="o">.</span><span class="n">topology</span><span class="p">()</span><span class="o">.</span><span class="n">dim</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">subdomains</span> <span class="o">=</span> <span class="n">MeshFunction</span><span class="p">(</span><span class="s1">&#39;size_t&#39;</span><span class="p">,</span> <span class="n">mesh</span><span class="p">,</span> <span class="n">mesh</span><span class="o">.</span><span class="n">topology</span><span class="p">()</span><span class="o">.</span><span class="n">dim</span><span class="p">())</span>


<span class="n">dx</span> <span class="o">=</span> <span class="n">Measure</span><span class="p">(</span><span class="s1">&#39;dx&#39;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">mesh</span><span class="p">,</span> <span class="n">subdomain_data</span><span class="o">=</span><span class="n">subdomains</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;quadrature_degree&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>


<span class="n">d</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">geometric_dimension</span><span class="p">()</span>
<span class="n">I</span> <span class="o">=</span> <span class="n">Identity</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>             <span class="c1"># Identity tensor</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">I</span> <span class="o">+</span> <span class="n">grad</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>             <span class="c1"># Deformation gradient</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">T</span><span class="o">*</span><span class="n">F</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">F</span><span class="o">*</span><span class="n">F</span><span class="o">.</span><span class="n">T</span>
<span class="n">Ic</span> <span class="o">=</span> <span class="n">tr</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
<span class="n">J</span>  <span class="o">=</span> <span class="n">det</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="n">Ib</span> <span class="o">=</span> <span class="n">tr</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>

<span class="n">Ic_bar</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">J</span><span class="p">,</span><span class="o">-</span><span class="mf">2.</span><span class="o">/</span><span class="mf">3.</span><span class="p">)</span><span class="o">*</span><span class="n">Ic</span>
<span class="n">C_bar</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">J</span><span class="p">,</span><span class="o">-</span><span class="mf">2.</span><span class="o">/</span><span class="mf">3.</span><span class="p">)</span><span class="o">*</span><span class="n">C</span>
<span class="n">B_bar</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">J</span><span class="p">,</span><span class="o">-</span><span class="mf">2.</span><span class="o">/</span><span class="mf">3.</span><span class="p">)</span><span class="o">*</span><span class="n">b</span>


<span class="k">def</span> <span class="nf">trapezoidal</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>

    <span class="n">h</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span> <span class="o">/</span> <span class="n">n</span>
    <span class="n">s</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">s</span> <span class="o">+=</span> <span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="n">f</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">i</span><span class="o">*</span><span class="n">h</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">+=</span> <span class="n">f</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span>
    <span class="k">return</span> <span class="n">s</span> <span class="o">*</span> <span class="n">h</span>

<span class="n">c_1</span> <span class="o">=</span> <span class="mf">10.</span>
<span class="n">c_3</span> <span class="o">=</span> <span class="mf">50.</span>
<span class="n">c_4</span> <span class="o">=</span> <span class="mf">5.</span>
<span class="n">gamma</span> <span class="o">=</span> <span class="mf">0.5772156649</span>

<span class="c1"># The fiber concentration factor</span>
<span class="n">K</span><span class="o">=</span><span class="mf">0.</span>

<span class="c1"># The bulk modulus</span>
<span class="n">KK</span> <span class="o">=</span>  <span class="mf">1E6</span>



<span class="k">def</span> <span class="nf">bessel</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>

    <span class="k">return</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">K</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

          <span class="o">.</span>
          <span class="o">.</span>
          <span class="o">.</span>

<span class="c1">######### Theta_p : Fiber preferred orientation  #########</span>

<span class="c1">#theta_p =  0           # Tangential orientation</span>
<span class="n">theta_p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">2.</span>  <span class="c1"># Meridional orientation</span>
<span class="c1">#theta_p = np.pi / 4.</span>

<span class="c1">######### This function returns:  P(theta) * F_2(lambda)  #########</span>

<span class="k">def</span> <span class="nf">stress_integral</span><span class="p">(</span><span class="n">theta</span><span class="p">):</span>
    <span class="n">a_vector</span> <span class="o">=</span> <span class="n">as_vector</span><span class="p">([</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">a1</span><span class="p">,</span> <span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">a2</span><span class="p">,</span> <span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">a3</span><span class="p">])</span>
    <span class="n">b_vector</span> <span class="o">=</span> <span class="n">as_vector</span><span class="p">([</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">b1</span><span class="p">,</span> <span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">b2</span><span class="p">,</span> <span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">b3</span><span class="p">])</span>
                        <span class="o">.</span>
                        <span class="o">.</span>
                        <span class="o">.</span>
                        <span class="o">.</span>


<span class="n">sigma_11</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">sigma_22</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">JJJ</span> <span class="o">=</span> <span class="p">[]</span>


<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">BC</span><span class="p">)):</span>
                <span class="o">.</span>
                <span class="o">.</span>
                <span class="o">.</span>
                <span class="o">.</span>


<span class="nb">print</span><span class="p">(</span><span class="n">sigma_11</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sigma_22</span><span class="p">)</span>
</pre></div>
</div>
<p>Here is the results and comparison with the analytical solution:</p>
<figure class="align-center" id="id18">
<img alt="../_images/10.png" src="../_images/10.png" />
<figcaption>
<p><span class="caption-number">Fig. 10 </span><span class="caption-text">Stress results of the von-Mises fiber model when a unit cube is under biaxial stretch in comparison with the analytical solution</span><a class="headerlink" href="#id18" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The complete FEniCS code is available upon request (Please refer to the section : <strong>About the Author</strong>)</p>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="package.html" class="btn btn-neutral float-left" title="Required Packages" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="multi-physics.html" class="btn btn-neutral float-right" title="2. Multi-Physics Problem" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Jafar Arash Mehr.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>